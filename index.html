
    <html lang="ko"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>Î©îÏù¥Ìîå ÌååÌã∞Î≥¥Ïä§ Í¥ÄÎ¶¨</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                overflow: hidden;
            }

            .header {
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                color: white;
                padding: 30px;
                text-align: center;
            }

            .header h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }

            .controls {
                background: #f8f9fa;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                align-items: center;
            }

            .btn {
                padding: 12px 20px;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-weight: bold;
                transition: all 0.3s ease;
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .btn-primary {
                background: #4CAF50;
                color: white;
            }

            .btn-primary:hover {
                background: #45a049;
                transform: translateY(-2px);
            }

            .btn-danger {
                background: #f44336;
                color: white;
            }

            .btn-danger:hover {
                background: #da190b;
                transform: translateY(-2px);
            }

            .filter-section {
                background: #e8f5e8;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
            }

            .filter-section h3 {
                color: #2e7d32;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .filter-controls {
                display: flex;
                gap: 15px;
                align-items: center;
                flex-wrap: wrap;
            }

            .filter-group {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .filter-group label {
                font-weight: bold;
                color: #2e7d32;
                white-space: nowrap;
            }

            .filter-input {
                padding: 10px 15px;
                border: 2px solid #4CAF50;
                border-radius: 8px;
                font-size: 16px;
                min-width: 250px;
            }

            .filter-input:focus {
                outline: none;
                border-color: #2e7d32;
                box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
            }

            .table-container {
                overflow-x: hidden;
                background: white;
                max-width: 100%;
            }

            .table-header {
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                color: white;
                display: grid;
                grid-template-columns: 35px 120px repeat(6, 90px) 70px 90px 70px 120px 100px;
                gap: 1px;
                font-weight: bold;
                text-align: center;
                padding: 12px 0;
            }

            .table-header div {
                padding: 8px 4px;
                cursor: pointer;
                transition: background-color 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 13px;
                position: relative;
            }

            .table-header div:hover {
                background: rgba(255,255,255,0.1);
            }

            .table-header div.sortable::after {
                content: ' ‚Üï';
                opacity: 0.5;
            }

            .table-header div.sorted-asc::after {
                content: ' ‚Üë';
                opacity: 1;
            }

            .table-header div.sorted-desc::after {
                content: ' ‚Üì';
                opacity: 1;
            }

            .party-row {
                display: grid;
                grid-template-columns: 35px 120px repeat(6, 90px) 70px 90px 70px 120px 100px;
                gap: 1px;
                border-bottom: 1px solid #dee2e6;
                transition: background-color 0.3s ease;
            }

            .party-row:hover {
                background: #f8f9fa;
            }

            .party-row.player-party {
                background: #e3f2fd;
            }

            .party-row.cleared-party {
                background: #f5f5f5;
                opacity: 0.6;
                color: #999;
            }

            .party-row.cleared-party .boss-cell {
                opacity: 0.7;
            }

            .party-row.cleared-party input,
            .party-row.cleared-party select {
                background-color: #f8f8f8;
                color: #999;
                border-color: #ddd;
            }

            .party-row.cleared-party .distribution-amount {
                color: #999;
            }

            .party-row > div {
                padding: 8px 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 40px;
            }

            .boss-cell {
                background: var(--boss-color, #4CAF50);
                color: white;
                border-radius: 5px;
                margin: 2px;
            }

            .boss-input, .character-input, .time-input, .auction-input {
                width: 100%;
                padding: 8px 6px;
                border: 1px solid #ddd;
                border-radius: 4px;
                text-align: center;
                font-size: 13px;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }

            .boss-input:focus, .character-input:focus, .time-input:focus, .auction-input:focus {
                outline: none;
                border-color: #4CAF50;
                box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
            }

            .character-input:placeholder-shown {
                background-color: #f8f9fa;
                color: #adb5bd;
                border-color: #e9ecef;
            }

            .character-input:placeholder-shown::placeholder {
                color: #adb5bd;
                font-size: 12px;
            }

            .clear-checkbox {
                width: 20px;
                height: 20px;
                cursor: pointer;
            }

            .distribution-amount {
                font-weight: bold;
                color: #2e7d32;
                cursor: help;
            }

            .stats-container {
                background: #f8f9fa;
                padding: 20px;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
            }

            .stat-item {
                background: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .stat-number {
                font-size: 2em;
                font-weight: bold;
                color: #4CAF50;
                margin-bottom: 5px;
            }

            .stat-label {
                color: #666;
                font-size: 0.9em;
            }

            .player-info {
                margin-top: 15px;
                padding: 15px;
                background: #f0f8f0;
                border-radius: 8px;
                border-left: 4px solid #4CAF50;
            }

            .player-info small {
                color: #2e7d32;
                display: block;
                margin-bottom: 5px;
            }

            .bulk-actions-section {
                background: #fff3cd;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
            }

            .bulk-actions-section h3 {
                color: #856404;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .bulk-actions {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                align-items: center;
            }

            .bulk-actions .btn {
                font-size: 14px;
                padding: 10px 15px;
            }

            @media (max-width: 1200px) {
                .table-header, .party-row {
                    grid-template-columns: 30px 100px repeat(6, 80px) 60px 80px 60px 100px 90px;
                }
            }

            @media (max-width: 768px) {
                .controls {
                    flex-direction: column;
                    align-items: stretch;
                }
                
                .btn {
                    margin: 5px 0;
                    padding: 12px 20px;
                    font-size: 14px;
                }
                
                .bulk-actions {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 8px;
                }
                
                .bulk-actions .btn {
                    margin: 2px 0;
                    padding: 10px 15px;
                    font-size: 13px;
                }
                
                .filter-controls {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 10px;
                }
                
                .filter-group {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 5px;
                }
                
                .filter-group label {
                    font-size: 14px;
                    margin-bottom: 5px;
                }
                
                .filter-input {
                    min-width: auto;
                    font-size: 16px; /* Î™®Î∞îÏùºÏóêÏÑú Ï§å Î∞©ÏßÄ */
                    padding: 12px 15px;
                }
                
                .table-header, .party-row {
                    grid-template-columns: 25px 80px repeat(6, 60px) 50px 60px 50px 80px 70px;
                    font-size: 11px;
                }
                
                .boss-input, .character-input, .time-input, .auction-input {
                    font-size: 12px;
                    padding: 6px 4px;
                }
                
                .table-header div {
                    padding: 6px 2px;
                    font-size: 11px;
                }
                
                .party-row > div {
                    padding: 6px 2px;
                    min-height: 35px;
                }
                
                .party-checkbox {
                    width: 14px !important;
                    height: 14px !important;
                    -webkit-tap-highlight-color: transparent;
                }
                
                /* Î™®Î∞îÏùºÏóêÏÑú ÌÑ∞Ïπò ÏòÅÏó≠ ÌôïÎåÄ */
                .table-header div, .party-row > div {
                    min-height: 44px; /* iOS Í∂åÏû• ÌÑ∞Ïπò ÏòÅÏó≠ */
                }
                
                /* Î™®Î∞îÏùºÏóêÏÑú Ïä§ÌÅ¨Î°§ Í∞úÏÑ† */
                .table-container {
                    -webkit-overflow-scrolling: touch;
                }
                
                .stats {
                    flex-direction: column;
                    gap: 10px;
                }
                
                .stat-item {
                    text-align: center;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üéÆ Î©îÏù¥Ìîå ÌååÌã∞Î≥¥Ïä§ Í¥ÄÎ¶¨</h1>
                <p>ÌååÌã∞ Í¥ÄÎ¶¨ &amp; Î∂ÑÎ∞∞Í∏à Í≥ÑÏÇ∞</p>
                <div id="githubStatus" style="margin-top: 5px; font-size: 12px; opacity: 0.8;"></div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="addParty()">
                    ‚ûï ÏÉà ÌååÌã∞ Ï∂îÍ∞Ä
                </button>
                <button class="btn btn-primary" onclick="saveAllData()">
                    üíæ Ï†ÄÏû•
                </button>
                <button class="btn btn-primary" onclick="setupGitHubAPI()">
                    ‚öôÔ∏è GitHub API ÏÑ§Ï†ï
                </button>
                <button class="btn btn-primary" onclick="saveAsFile()">
                    üìÅ ÌååÏùºÎ°ú Ï†ÄÏû•
                </button>
                <button class="btn btn-danger" onclick="deleteSelectedParties()">
                    ‚úÖ ÏÑ†ÌÉùÎêú ÌååÌã∞ ÏÇ≠Ï†ú
                </button>
                <button class="btn btn-danger" onclick="clearAllParties()">
                    üóëÔ∏è Î™®Îì† ÌååÌã∞ ÏÇ≠Ï†ú
                </button>
            </div>

            <div class="filter-section">
                <h3>üîç ÌååÌã∞ ÌïÑÌÑ∞</h3>
                <div class="filter-controls">
                    <div class="filter-group">
                        <label>ÌîåÎ†àÏù¥Ïñ¥:</label>
                        <input type="text" id="playerFilterInput" class="filter-input" placeholder="ÌîåÎ†àÏù¥Ïñ¥Î™Ö ÏûÖÎ†•..." onkeyup="filterByPlayer(this.value)" onblur="filterByPlayer(this.value)" title="ÌîåÎ†àÏù¥Ïñ¥Î™ÖÏùÑ ÏûÖÎ†•ÌïòÎ©¥ Ìï¥Îãπ ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï∞∏Ïó¨ÌïòÎäî ÌååÌã∞Î•º Ïö∞ÏÑ†Ï†ÅÏúºÎ°ú Î≥¥Ïó¨Ï§çÎãàÎã§">
                    </div>
                    <div class="filter-group">
                        <label>Î≥¥Ïä§:</label>
                        <input type="text" id="bossFilterInput" class="filter-input" placeholder="Î≥¥Ïä§Î™Ö ÏûÖÎ†•..." onkeyup="filterByBoss(this.value)" onblur="filterByBoss(this.value)" title="Î≥¥Ïä§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÎ©¥ Ìï¥Îãπ Î≥¥Ïä§ ÌååÌã∞Îßå Î≥¥Ïó¨Ï§çÎãàÎã§">
                    </div>
                    <button class="btn btn-primary" onclick="showAllParties()" title="Î™®Îì† ÌååÌã∞Î•º ÌëúÏãúÌï©ÎãàÎã§">
                        üë• Ï†ÑÏ≤¥ Î≥¥Í∏∞
                    </button>
                    <button class="btn btn-primary" onclick="showPlayerParties()" title="ÏûÖÎ†•Ìïú ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï∞∏Ïó¨ÌïòÎäî ÌååÌã∞Îßå ÌëúÏãúÌï©ÎãàÎã§">
                        üéØ ÌîåÎ†àÏù¥Ïñ¥ ÌååÌã∞Îßå Î≥¥Í∏∞
                    </button>
                </div>
                <div class="player-info">
                    <small>üí° ÌîåÎ†àÏù¥Ïñ¥Î™ÖÏùÑ ÏûÖÎ†•ÌïòÎ©¥ Ìï¥Îãπ ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï∞∏Ïó¨ÌïòÎäî ÌååÌã∞Î•º Ïö∞ÏÑ†Ï†ÅÏúºÎ°ú Î≥¥Ïó¨Ï§çÎãàÎã§.</small>
                </div>
            </div>

            <div class="bulk-actions-section">
                <h3>üóëÔ∏è ÏùºÍ¥Ñ ÏÇ≠Ï†ú</h3>
                <div class="bulk-actions">
                    <button class="btn btn-danger" onclick="clearAllDays()" title="Î™®Îì† ÌååÌã∞Ïùò ÏöîÏùºÏùÑ ÏÇ≠Ï†úÌï©ÎãàÎã§">
                        üìÖ ÏöîÏùº ÏùºÍ¥Ñ ÏÇ≠Ï†ú
                    </button>
                    <button class="btn btn-danger" onclick="clearAllTimes()" title="Î™®Îì† ÌååÌã∞Ïùò ÏãúÍ∞ÑÏùÑ ÏÇ≠Ï†úÌï©ÎãàÎã§">
                        ‚è∞ ÏãúÍ∞Ñ ÏùºÍ¥Ñ ÏÇ≠Ï†ú
                    </button>
                    <button class="btn btn-danger" onclick="clearAllCleared()" title="Î™®Îì† ÌååÌã∞Ïùò ÌÅ¥Î¶¨Ïñ¥ ÏÉÅÌÉúÎ•º Ìï¥Ï†úÌï©ÎãàÎã§">
                        ‚úÖ ÌÅ¥Î¶¨Ïñ¥ ÏùºÍ¥Ñ Ìï¥Ï†ú
                    </button>
                    <button class="btn btn-danger" onclick="clearAllAuctionPrices()" title="Î™®Îì† ÌååÌã∞Ïùò Í≤ΩÎß§Ïû• ÌåêÎß§Í∞ÄÎ•º ÏÇ≠Ï†úÌï©ÎãàÎã§">
                        üí∞ Í≤ΩÎß§Ïû• ÌåêÎß§Í∞Ä ÏùºÍ¥Ñ ÏÇ≠Ï†ú
                    </button>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header" id="tableHeader">
                    <div>
                        <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                    </div>
                    <div class="sortable" onclick="sortTable('boss')">Î≥¥Ïä§</div>
                    <div class="header-input" data-index="0" contenteditable="true" onblur="updateHeader(0, this.textContent)">Ï∞ΩÌò∏</div>
                    <div class="header-input" data-index="1" contenteditable="true" onblur="updateHeader(1, this.textContent)">Í¥ëÎØº</div>
                    <div class="header-input" data-index="2" contenteditable="true" onblur="updateHeader(2, this.textContent)">ÌÉúÌõà</div>
                    <div class="header-input" data-index="3" contenteditable="true" onblur="updateHeader(3, this.textContent)">ÏùÄÍ∑ú</div>
                    <div class="header-input" data-index="4" contenteditable="true" onblur="updateHeader(4, this.textContent)">Ï§ÄÏàò</div>
                    <div class="header-input" data-index="5" contenteditable="true" onblur="updateHeader(5, this.textContent)">ÏßÄÌõà</div>
                    <div class="sortable" onclick="sortTable('day')">ÏöîÏùº</div>
                    <div class="sortable" onclick="sortTable('time')">ÏãúÍ∞Ñ</div>
                    <div class="sortable" onclick="sortTable('cleared')">ÌÅ¥Î¶¨Ïñ¥</div>
                    <div class="sortable" onclick="sortTable('auctionPrice')">Í≤ΩÎß§Ïû• ÌåêÎß§Í∞Ä</div>
                    <div class="sortable" onclick="sortTable('distribution')">Î∂ÑÎ∞∞Í∏à</div>
                </div>
                <div id="partyTableBody"><div class="party-row player-party" data-party-id="1">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="1" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ Ïπ¥ÎßÅ" onchange="updateParty(1, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î≥¥Îßà" onchange="updateParty(1, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏóêÎ∞ò" onchange="updateParty(1, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(1, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(1, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(1)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(1, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="2">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="2" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #4ECDC4">
                            <input type="text" class="boss-input" value="ÏùµÏä§ Ïä§Ïö∞" onchange="updateParty(2, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î≥¥Îßà" onchange="updateParty(2, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÎπÑÏàç" onchange="updateParty(2, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(2, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(2, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(2)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(2, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="3">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="3" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ Ïπ¥ÎßÅ" onchange="updateParty(3, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_0_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÎπÑÏàç" onchange="updateParty(3, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÌûàÏñ¥Î°ú" onchange="updateParty(3, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(3, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(3, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(3)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(3, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="5">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="5" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê" onchange="updateParty(5, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏùÄÏõî" onchange="updateParty(5, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î∂àÎèÖ" onchange="updateParty(5, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(5, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(5, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(5)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(5, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="7">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="7" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="ÌïòÎìú ÏÑ∏Î†å" onchange="updateParty(7, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_0_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î∂àÎèÖ" onchange="updateParty(7, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏúàÎ∏å" onchange="updateParty(7, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(7, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à" selected="">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(7, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(7)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(7, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="8">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="8" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÏπºÎ°úÏä§" onchange="updateParty(8, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_0_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î∂àÎèÖ" onchange="updateParty(8, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏúàÎ∏å" onchange="updateParty(8, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(8, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à" selected="">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(8, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(8)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(8, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="4">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="4" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="ÌïòÎìú ÏÑ∏Î†å" onchange="updateParty(4, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏùÄÏõî" onchange="updateParty(4, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÌûàÏñ¥Î°ú" onchange="updateParty(4, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(4, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(4, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(4)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(4, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="6">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="6" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ Ïπ¥ÎßÅ" onchange="updateParty(6, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏùÄÏõî" onchange="updateParty(6, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏïÑÎç∏" onchange="updateParty(6, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(6, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(6, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(6)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(6, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="9">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="9" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="ÌïòÎìú ÏÑ∏Î†å" onchange="updateParty(9, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏïÑÎûÄ" onchange="updateParty(9, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïã†Í∂Å" onchange="updateParty(9, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÎπÑÏàç" onchange="updateParty(9, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(9, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(9, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(9)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(9, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="10">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="10" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê" onchange="updateParty(10, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏïÑÎûÄ" onchange="updateParty(10, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïã†Í∂Å" onchange="updateParty(10, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(10, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(10, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(10)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(10, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="11">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="11" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÏπºÎ°úÏä§" onchange="updateParty(11, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏïÑÎûÄ" onchange="updateParty(11, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïã†Í∂Å" onchange="updateParty(11, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(11, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(11, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(11)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(11, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="12">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="12" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ Ïπ¥ÎßÅ" onchange="updateParty(12, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÏïÑÎûÄ" onchange="updateParty(12, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïã†Í∂Å" onchange="updateParty(12, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ï†úÎ°ú" onchange="updateParty(12, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(12, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(12, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(12)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(12, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="13">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="13" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="ÌïòÎìú ÏÑ∏Î†å" onchange="updateParty(13, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïç¨ÏΩú" onchange="updateParty(13, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ìå®Ìåå" onchange="updateParty(13, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ï†úÎ°ú" onchange="updateParty(13, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(13, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(13, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(13)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(13, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="14">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="14" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê" onchange="updateParty(14, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïç¨ÏΩú" onchange="updateParty(14, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ìå®Ìåå" onchange="updateParty(14, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ï†úÎ°ú" onchange="updateParty(14, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(14, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(14, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(14)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(14, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="15">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="15" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÏπºÎ°úÏä§" onchange="updateParty(15, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ïç¨ÏΩú" onchange="updateParty(15, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ìå®Ìåå" onchange="updateParty(15, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Ï†úÎ°ú" onchange="updateParty(15, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(15, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(15, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(15)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(15, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="16">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="16" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #4ECDC4">
                            <input type="text" class="boss-input" value="ÏùµÏä§ Ïä§Ïö∞" onchange="updateParty(16, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î∂àÎèÖ" onchange="updateParty(16, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="ÌûàÏñ¥Î°ú" onchange="updateParty(16, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_4_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(16, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(16, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(16)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(16, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="17">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="17" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="ÌïòÎìú ÏÑ∏Î†å" onchange="updateParty(17, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(17, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(17, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(17, 'characters', 'char_5_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(17, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(17, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(17)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(17, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="18">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="18" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê" onchange="updateParty(18, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(18, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(18, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_5_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(18, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(18, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(18)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(18, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="19">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="19" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="Ïù¥ÏßÄ ÏπºÎ°úÏä§" onchange="updateParty(19, 'boss', this.value)" placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(19, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_1_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_2_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_3_' + this.value)" placeholder="Îπà Ïä¨Î°Ø" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(19, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="Î†å" onchange="updateParty(19, 'characters', 'char_5_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(19, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî">Ïõî</option>
                                <option value="Ìôî">Ìôî</option>
                                <option value="Ïàò">Ïàò</option>
                                <option value="Î™©">Î™©</option>
                                <option value="Í∏à">Í∏à</option>
                                <option value="ÌÜ†">ÌÜ†</option>
                                <option value="Ïùº">Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(19, 'time', this.value)" placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(19)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(19, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0Î©îÏÜå</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä 0Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä 0Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° 0Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° 0Î©îÏÜå">
                                0Î©îÏÜå
                            </div>
                        </div>
                    </div></div>
            </div>

            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-number" id="totalParties">19</div>
                    <div class="stat-label">Ï¥ù ÌååÌã∞ Ïàò</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="clearedParties">0</div>
                    <div class="stat-label">ÌÅ¥Î¶¨Ïñ¥Ìïú ÌååÌã∞</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalAuctionPrice">0Î©îÏÜå</div>
                    <div class="stat-label">Ï¥ù Í≤ΩÎß§Ïû• ÌåêÎß§Í∞Ä</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalDistribution">0Î©îÏÜå</div>
                    <div class="stat-label">Ï¥ù Î∂ÑÎ∞∞ Í∞ÄÎä• Í∏àÏï°</div>
                </div>
            </div>
        </div>

        <script>
            // Ï†ÑÏó≠ Î≥ÄÏàò
            let parties = [];
            let partyCounter = 1;
            let currentSort = { column: null, direction: 'asc' };
            let currentPlayer = '';
            let currentBoss = '';
            let filteredParties = null; // null = ÌïÑÌÑ∞ ÏóÜÏùå, Î∞∞Ïó¥ = ÌïÑÌÑ∞ Ï†ÅÏö©Îê®
            
            // GitHub API ÏÑ§Ï†ï (ÏùºÏãúÏ†ÅÏúºÎ°ú ÎπÑÌôúÏÑ±Ìôî)
            let githubConfig = {
                token: '',
                owner: 'rlarhkd99-beep',
                repo: 'Maple',
                filePath: 'data/maple_party_data.json',
                enabled: true // GitHub API ÌôúÏÑ±Ìôî
            };

            // Î≥¥Ïä§Î≥Ñ ÏÉâÏÉÅ Îß§Ìïë
            const bossColors = {
                'Ïù¥ÏßÄ Ïπ¥ÎßÅ': '#FF6B6B',
                'ÏùµÏä§ Ïä§Ïö∞': '#4ECDC4',
                'ÌïòÎìú ÏÑ∏Î†å': '#45B7D1',
                'Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê': '#96CEB4',
                'Ïù¥ÏßÄ ÏπºÎ°úÏä§': '#FFEAA7',
                'ÌïòÎìú Ïπ¥ÎßÅ': '#DDA0DD',
                'ÏùµÏä§ Ïπ¥ÎßÅ': '#98D8C8',
                'ÌïòÎìú Ïä§Ïö∞': '#F7DC6F',
                'ÏùµÏä§ ÏÑ∏Î†å': '#BB8FCE',
                'ÌïòÎìú ÎåÄÏ†ÅÏûê': '#85C1E9',
                'ÏùµÏä§ ÎåÄÏ†ÅÏûê': '#F8C471',
                'ÌïòÎìú ÏπºÎ°úÏä§': '#82E0AA',
                'ÏùµÏä§ ÏπºÎ°úÏä§': '#F1948A'
            };

            // Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞Îäî DOMContentLoadedÏóêÏÑú Ï†ïÏùòÎê®

            // Ï¥àÍ∏∞Ìôî
            document.addEventListener('DOMContentLoaded', function() {
                // EMBEDDED_DATA Ï†ïÏùò
                window.EMBEDDED_DATA = {
        "parties": [
            {
                "id": 1,
                "characters": [
                    "Î≥¥Îßà",
                    "ÏóêÎ∞ò",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "Ïù¥ÏßÄ Ïπ¥ÎßÅ",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 2,
                "characters": [
                    "Î≥¥Îßà",
                    "ÎπÑÏàç",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "ÏùµÏä§ Ïä§Ïö∞",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 3,
                "characters": [
                    "",
                    "ÎπÑÏàç",
                    "",
                    "ÌûàÏñ¥Î°ú",
                    "",
                    ""
                ],
                "boss": "Ïù¥ÏßÄ Ïπ¥ÎßÅ",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 4,
                "characters": [
                    "ÏùÄÏõî",
                    "",
                    "",
                    "ÌûàÏñ¥Î°ú",
                    "",
                    ""
                ],
                "boss": "ÌïòÎìú ÏÑ∏Î†å",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 5,
                "characters": [
                    "ÏùÄÏõî",
                    "Î∂àÎèÖ",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 6,
                "characters": [
                    "ÏùÄÏõî",
                    "",
                    "",
                    "",
                    "ÏïÑÎç∏",
                    ""
                ],
                "boss": "Ïù¥ÏßÄ Ïπ¥ÎßÅ",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 7,
                "characters": [
                    "",
                    "Î∂àÎèÖ",
                    "",
                    "ÏúàÎ∏å",
                    "",
                    ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                            "auctionPrice": 0
            },
            {
                "id": 8,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                    "",
                                "",
                                "ÏïÑÎç∏"
                ],
                            "boss": "Ïù¥ÏßÄ Ïπ¥ÎßÅ",
                "time": "",
                "cleared": false,
                            "auctionPrice": 0
            },
            {
                "id": 9,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                                "",
                                "ÏïÑÎç∏",
                    ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 10,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                    "",
                                "",
                                "ÏïÑÎç∏"
                ],
                "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 11,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                    "",
                                "ÏïÑÎç∏",
                    ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 12,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                                "",
                                "",
                                "ÏïÑÎç∏"
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 13,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                                "",
                                "ÏïÑÎç∏",
                    ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 14,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                                "",
                                "",
                                "ÏïÑÎç∏"
                ],
                "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 15,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                                "",
                                "ÏïÑÎç∏",
                    ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 16,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                    "",
                                "",
                                "ÏïÑÎç∏"
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 17,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                    "",
                                "ÏïÑÎç∏",
                                ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 18,
                "characters": [
                                "ÏùÄÏõî",
                    "",
                    "",
                    "",
                                "",
                                "ÏïÑÎç∏"
                ],
                "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 19,
                "characters": [
                    "",
                                "Î∂àÎèÖ",
                    "",
                    "",
                                "ÏïÑÎç∏",
                                ""
                ],
                            "boss": "Ïù¥ÏßÄ ÎåÄÏ†ÅÏûê",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            }
        ],
        "partyCounter": 20,
        "headerData": [
            "Ï∞ΩÌò∏",
            "Í¥ëÎØº",
            "ÌÉúÌõà",
            "ÏùÄÍ∑ú",
            "Ï§ÄÏàò",
            "ÏßÄÌõà"
                    ]
                };
                
                // EMBEDDED_DATA Ï†ïÏùò ÌõÑ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                loadData();
            });

            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§ (Ctrl+SÎ°ú Ï†ÄÏû•)
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    saveAllData();
                }
            });

            // Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            function loadData() {
                console.log('loadData ÏãúÏûë');
                
                // EMBEDDED_DATAÏóêÏÑú 19Í∞ú ÌååÌã∞ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                if (window.EMBEDDED_DATA && window.EMBEDDED_DATA.parties) {
                    // Ï†ÑÏó≠ Î≥ÄÏàòÏóê Î™ÖÏãúÏ†ÅÏúºÎ°ú Ìï†Îãπ
                    window.parties = [...window.EMBEDDED_DATA.parties];
                    window.partyCounter = window.EMBEDDED_DATA.partyCounter;
                    
                    // Í∏∞Ï°¥ Î≥ÄÏàòÏóêÎèÑ Ìï†Îãπ
                    parties = window.parties;
                    partyCounter = window.partyCounter;
                    
                    console.log('loadData - EMBEDDED_DATAÏóêÏÑú Î°úÎìú:', parties.length, 'Í∞ú');
                    console.log('loadData - Ï≤´ Î≤àÏß∏ ÌååÌã∞:', parties[0]);
                    console.log('loadData - parties Î∞∞Ïó¥ Ï†ÑÏ≤¥:', parties);
                } else {
                    console.error('EMBEDDED_DATAÍ∞Ä Ï†ïÏùòÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                    return;
                }
                
                // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                saveData();
                
                // ÌÖåÏù¥Î∏î Î†åÎçîÎßÅ
                renderTable();
            }
            
            // Í≥µÏú† Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            function loadSharedData(data) {
                console.log('loadSharedData - Î∞õÏùÄ Îç∞Ïù¥ÌÑ∞:', data);
                console.log('loadSharedData - data.parties:', data.parties);
                
                        parties = data.parties || [];
                        partyCounter = data.partyCounter || 1;
                        
                console.log('loadSharedData - parties ÏÑ§Ï†ï ÌõÑ:', parties);
                console.log('loadSharedData - parties.length:', parties.length);
                
                // Í≥µÏú†Îêú Îç∞Ïù¥ÌÑ∞Î•º Î°úÏª¨ÏóêÎèÑ Ï†ÄÏû•
                saveData();
                
                // Ìó§Îçî Îç∞Ïù¥ÌÑ∞ÎèÑ Î≥µÏõê
                if (data.headerData) {
                    const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                    data.headerData.forEach((value, index) => {
                        if (headerCells[index]) {
                            headerCells[index].textContent = value;
                        }
                    });
                    saveHeaderData();
                }
                
                // Ï†ïÎ†¨ ÏÉÅÌÉú Î≥µÏõê
                if (data.sortState) {
                    currentSort = data.sortState;
                    saveSortState();
                }
                
                // ÌïÑÌÑ∞ ÏÉÅÌÉú Î≥µÏõê
                if (data.filterState) {
                    currentPlayer = data.filterState.currentPlayer || '';
                    currentBoss = data.filterState.currentBoss || '';
                    
                    const playerFilterInput = document.getElementById('playerFilterInput');
                    const bossFilterInput = document.getElementById('bossFilterInput');
                    
                    if (playerFilterInput) playerFilterInput.value = currentPlayer;
                    if (bossFilterInput) bossFilterInput.value = currentBoss;
                    
                    if (data.filterState.filteredParties) {
                        filteredParties = parties.filter(p => data.filterState.filteredParties.includes(p.id));
                    }
                    saveFilterState();
                }
                
                console.log('Í≥µÏú†Îêú Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î°úÎìúÌñàÏäµÎãàÎã§.');
                
                // Í≥µÏú†Îêú Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏïåÎ¶º
                setTimeout(() => {
                    alert('üîó Í≥µÏú†Îêú Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î°úÎìúÌñàÏäµÎãàÎã§!\n\nÏù¥Ï†ú Îã§Î•∏ ÏÇ¨Ïö©ÏûêÏôÄ Í∞ôÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Í≥µÏú†ÌïòÍ≥† ÏûàÏäµÎãàÎã§.');
                }, 500);
            }
            
            // GitHub ÎòêÎäî Î°úÏª¨ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            async function loadFromGitHubOrLocal() {
                // GitHub API ÏÑ§Ï†ï Î°úÎìú
                loadGitHubConfig();
                updateGitHubStatus();
                
                // GitHub APIÍ∞Ä ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÍ≥† ÌÜ†ÌÅ∞Ïù¥ ÏûàÏúºÎ©¥ GitHubÏóêÏÑú Î°úÎìú
                if (githubConfig.enabled && githubConfig.token) {
                    console.log('GitHub APIÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌï©ÎãàÎã§.');
                    const success = await loadDataFromGitHub();
                    if (success) {
                        console.log('GitHubÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ');
                        return;
                } else {
                        console.log('GitHubÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®, Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                    }
                }
                
                // GitHub APIÍ∞Ä ÎπÑÌôúÏÑ±ÌôîÎêòÏóàÍ±∞ÎÇò Ïã§Ìå®Ìïú Í≤ΩÏö∞ Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                console.log('Î°úÏª¨ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.');
                loadFromLocalStorage();
            }
            
            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            function loadFromLocalStorage() {
                // EMBEDDED_DATAÍ∞Ä Ï†ïÏùòÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                if (!window.EMBEDDED_DATA) {
                    console.error('EMBEDDED_DATAÍ∞Ä Ï†ïÏùòÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                    return;
                }
                
                console.log('loadFromLocalStorage - EMBEDDED_DATA ÌôïÏù∏:', window.EMBEDDED_DATA);
                console.log('loadFromLocalStorage - EMBEDDED_DATA.parties:', window.EMBEDDED_DATA.parties);
                
                // Í∞ïÏ†úÎ°ú Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                console.log('loadFromLocalStorage - Í∞ïÏ†úÎ°ú Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©');
                parties = [...window.EMBEDDED_DATA.parties];
                partyCounter = window.EMBEDDED_DATA.partyCounter;
                
                console.log('loadFromLocalStorage - Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', parties.length, 'Í∞ú');
                console.log('loadFromLocalStorage - Ï≤´ Î≤àÏß∏ ÌååÌã∞:', parties[0]);
                
                // Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                saveData();
                
                filteredParties = null;
                loadHeaderData();
                loadSortState();
                loadFilterState();
            }

            // Ìó§Îçî Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            function loadHeaderData() {
                const saved = localStorage.getItem('maplePartyHeaderData');
                
                if (saved) {
                    try {
                        const headerValues = JSON.parse(saved);
                        const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                        headerValues.forEach((value, index) => {
                            if (headerCells[index]) {
                                headerCells[index].textContent = value;
                            }
                        });
                    } catch (error) {
                        console.error('Ìó§Îçî Îç∞Ïù¥ÌÑ∞ ÌååÏã± Ïò§Î•ò:', error);
                        loadDefaultHeaders();
                    }
                } else {
                    loadDefaultHeaders();
                }
            }

            // Í∏∞Î≥∏ Ìó§Îçî Î°úÎìú
            function loadDefaultHeaders() {
                const defaultHeaders = window.EMBEDDED_DATA.headerData;
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                defaultHeaders.forEach((value, index) => {
                    if (headerCells[index]) {
                        headerCells[index].textContent = value;
                    }
                });
                localStorage.setItem('maplePartyHeaderData', JSON.stringify(defaultHeaders));
            }

            // Ï†ïÎ†¨ ÏÉÅÌÉú Î°úÎìú
            function loadSortState() {
                const saved = localStorage.getItem('maplePartySortState');
                if (saved) {
                    try {
                        currentSort = JSON.parse(saved);
                    } catch (error) {
                        console.error('Ï†ïÎ†¨ ÏÉÅÌÉú ÌååÏã± Ïò§Î•ò:', error);
                        currentSort = { column: null, direction: 'asc' };
                    }
                }
            }

            // ÌïÑÌÑ∞ ÏÉÅÌÉú Î°úÎìú
            function loadFilterState() {
                const saved = localStorage.getItem('maplePartyFilterState');
                if (saved) {
                    try {
                        const filterState = JSON.parse(saved);
                        currentPlayer = filterState.currentPlayer || '';
                        currentBoss = filterState.currentBoss || '';
                        
                        const playerFilterInput = document.getElementById('playerFilterInput');
                        if (playerFilterInput) {
                            playerFilterInput.value = currentPlayer;
                        }
                        
                        const bossFilterInput = document.getElementById('bossFilterInput');
                        if (bossFilterInput) {
                            bossFilterInput.value = currentBoss;
                        }
                        
                        // ÌïÑÌÑ∞ ÏÉÅÌÉú Î≥µÏõê
                        if (filterState.hasFilter) {
                            applyFilters();
                        } else {
                            filteredParties = null;
                        }
                    } catch (error) {
                        console.error('ÌïÑÌÑ∞ ÏÉÅÌÉú ÌååÏã± Ïò§Î•ò:', error);
                        currentPlayer = '';
                        currentBoss = '';
                        filteredParties = null;
                    }
                }
            }

            // ÌååÌã∞ Ï∂îÍ∞Ä
            function addParty() {
                const party = {
                    id: partyCounter++,
                    characters: ['', '', '', '', '', ''],
                    boss: '',
                    day: '',
                    time: '',
                    cleared: false,
                    auctionPrice: 0
                };
                parties.push(party);
                saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                renderTable();
            }



            // Î™®Îì† ÌååÌã∞ ÏÇ≠Ï†ú
            function clearAllParties() {
                if (confirm('Î™®Îì† ÌååÌã∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    parties = [];
                    partyCounter = 1;
                    filteredParties = [];
                    currentPlayer = '';
                    currentSort = { column: null, direction: 'asc' };
                    
                    localStorage.removeItem('maplePartyBossData');
                    localStorage.removeItem('maplePartyHeaderData');
                    localStorage.removeItem('maplePartySortState');
                    localStorage.removeItem('maplePartyFilterState');
                    
                    const filterInput = document.getElementById('playerFilterInput');
                    if (filterInput) {
                        filterInput.value = '';
                    }
                    
                    renderTable();
                    alert('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            // ÏÑ†ÌÉùÎêú ÌååÌã∞ ÏÇ≠Ï†ú
            function deleteSelectedParties() {
                const selectedCheckboxes = document.querySelectorAll('.party-checkbox:checked');
                if (selectedCheckboxes.length === 0) {
                    alert('ÏÇ≠Ï†úÌï† ÌååÌã∞Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                if (confirm(`ÏÑ†ÌÉùÎêú ${selectedCheckboxes.length}Í∞úÏùò ÌååÌã∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                    const selectedIds = Array.from(selectedCheckboxes).map(cb => parseInt(cb.dataset.partyId));
                    parties = parties.filter(party => !selectedIds.includes(party.id));
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                    alert(`${selectedIds.length}Í∞úÏùò ÌååÌã∞Í∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`);
                }
            }

            // Ï†ÑÏ≤¥ ÏÑ†ÌÉù/Ìï¥Ï†ú
            function toggleSelectAll() {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const partyCheckboxes = document.querySelectorAll('.party-checkbox');
                
                partyCheckboxes.forEach(checkbox => {
                    checkbox.checked = selectAllCheckbox.checked;
                });
            }

            // ÌååÌã∞ ÏÑ†ÌÉù ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            function updatePartySelection() {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const partyCheckboxes = document.querySelectorAll('.party-checkbox');
                const checkedCheckboxes = document.querySelectorAll('.party-checkbox:checked');
                
                if (checkedCheckboxes.length === 0) {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = false;
                } else if (checkedCheckboxes.length === partyCheckboxes.length) {
                    selectAllCheckbox.checked = true;
                    selectAllCheckbox.indeterminate = false;
                } else {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = true;
                }
            }



            // ÌååÌã∞ ÏóÖÎç∞Ïù¥Ìä∏
            function updateParty(id, field, value) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    if (field === 'characters') {
                        const charIndex = parseInt(value.split('_')[1]);
                        party.characters[charIndex] = value.split('_')[2];
                        
                        // Ï∫êÎ¶≠ÌÑ∞ ÏûÖÎ†• ÌïÑÎìú Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏
                        const row = document.querySelector(`div[data-party-id="${id}"]`);
                        if (row) {
                            const charInput = row.querySelector(`input[onchange*="char_${charIndex}_"]`);
                            if (charInput) {
                                if (party.characters[charIndex] && party.characters[charIndex].trim() !== '') {
                                    // Ï∫êÎ¶≠ÌÑ∞Í∞Ä ÏûàÏúºÎ©¥ ÏùºÎ∞ò Ïä§ÌÉÄÏùº
                                    charInput.style.backgroundColor = '';
                                    charInput.style.color = '';
                                    charInput.style.borderColor = '';
                                    charInput.placeholder = '';
                                } else {
                                    // Ï∫êÎ¶≠ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ ÏùÄÏùÄÌïú Ïä§ÌÉÄÏùº
                                    charInput.style.backgroundColor = '#f8f9fa';
                                    charInput.style.color = '#adb5bd';
                                    charInput.style.borderColor = '#e9ecef';
                                    charInput.placeholder = 'Îπà Ïä¨Î°Ø';
                                }
                            }
                        }
                    } else {
                        party[field] = value;
                    }
                    
                    if (field === 'boss') {
                        const row = document.querySelector(`div[data-party-id="${id}"]`);
                        if (row) {
                            const bossCell = row.querySelector('.boss-cell');
                            if (bossCell) {
                                bossCell.style.setProperty('--boss-color', getBossColor(value));
                            }
                        }
                    }
                    
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                }
            }

            // ÌÅ¥Î¶¨Ïñ¥ ÌÜ†Í∏Ä
            function toggleClear(id) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    party.cleared = !party.cleared;
                    
                    // ÌÅ¥Î¶¨Ïñ¥ ÏÉÅÌÉúÏóê Îî∞Îùº CSS ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä/Ï†úÍ±∞
                    const row = document.querySelector(`div[data-party-id="${id}"]`);
                    if (row) {
                        if (party.cleared) {
                            row.classList.add('cleared-party');
                        } else {
                            row.classList.remove('cleared-party');
                        }
                    }
                    
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                }
            }

            // ÌÖåÏù¥Î∏î Ï†ïÎ†¨
            function sortTable(column) {
                if (currentSort.column === column) {
                    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.column = column;
                    currentSort.direction = 'asc';
                }

                const partiesToSort = filteredParties.length > 0 ? filteredParties : parties;
                partiesToSort.sort((a, b) => {
                    let aVal, bVal;
                    
                    switch(column) {
                        case 'boss':
                            aVal = a.boss || '';
                            bVal = b.boss || '';
                            break;
                        case 'day':
                            aVal = a.day || '';
                            bVal = b.day || '';
                            break;
                        case 'time':
                            aVal = a.time || '';
                            bVal = b.time || '';
                            break;
                        case 'cleared':
                            aVal = a.cleared ? 1 : 0;
                            bVal = b.cleared ? 1 : 0;
                            break;
                        case 'auctionPrice':
                            aVal = parseInt(a.auctionPrice) || 0;
                            bVal = parseInt(b.auctionPrice) || 0;
                            break;
                        case 'distribution':
                            aVal = calculateDistribution(a);
                            bVal = calculateDistribution(b);
                            break;
                        default:
                            return 0;
                    }

                    if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                    if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                    return 0;
                });

                updateSortHeaders();
                renderTable();
                saveSortState();
            }

            // Ï†ïÎ†¨ Ìó§Îçî ÏóÖÎç∞Ïù¥Ìä∏
            function updateSortHeaders() {
                const headers = document.querySelectorAll('.table-header div.sortable');
                headers.forEach(header => {
                    header.classList.remove('sorted-asc', 'sorted-desc');
                    if (header.onclick.toString().includes(currentSort.column)) {
                        header.classList.add(currentSort.direction === 'asc' ? 'sorted-asc' : 'sorted-desc');
                    }
                });
            }

            // Ìó§Îçî ÏóÖÎç∞Ïù¥Ìä∏
            function updateHeader(index, value) {
                saveHeaderData();
            }

            // Î≥¥Ïä§ ÏÉâÏÉÅ Í∞ÄÏ†∏Ïò§Í∏∞
            function getBossColor(bossName) {
                return bossColors[bossName] || '#4CAF50';
            }

            // Ï∞∏Ïó¨Ïûê Ïàò Í≥ÑÏÇ∞
            function getParticipantCount(party) {
                return party.characters.filter(char => char && char.trim() !== '').length;
            }

            // Î∂ÑÎ∞∞Í∏à Í≥ÑÏÇ∞
            function calculateDistribution(party) {
                const participantCount = getParticipantCount(party);
                const auctionPrice = parseInt(party.auctionPrice) || 0;
                
                if (participantCount === 0 || auctionPrice === 0) {
                    return 0;
                }
                
                const feeRate = 0.03;
                const totalMembers = participantCount;
                
                const receivedAmount = Math.round(auctionPrice * (1 - feeRate));
                const actualReceivedAmount = Math.round(receivedAmount / (1 + (totalMembers - 1) / (1 - feeRate)));
                const distributionAmount = Math.round(actualReceivedAmount / (1 - feeRate));
                
                return distributionAmount;
            }

            // Ïà´ÏûêÏóê ÏΩ§Îßà Ï∂îÍ∞Ä
            function addCommas(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }

            // Ïñµ/Îßå Îã®ÏúÑÎ°ú Î≥ÄÌôò
            function formatToKoreanCurrency(num) {
                if (num === 0) return '0Î©îÏÜå';
                
                const eok = Math.floor(num / 100000000);
                const man = Math.floor((num % 100000000) / 10000);
                const remainder = num % 10000;
                
                let result = '';
                if (eok > 0) result += `${eok}Ïñµ`;
                if (man > 0) result += `${man}Îßå`;
                if (remainder > 0) result += `${remainder}`;
                
                return result + 'Î©îÏÜå';
            }

            // Í≤ΩÎß§Ïû• Í∞ÄÍ≤© ÏóÖÎç∞Ïù¥Ìä∏
            function updateAuctionPrice(id, value) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    // ÏΩ§Îßà Ï†úÍ±∞ ÌõÑ Ïà´ÏûêÎßå Ï∂îÏ∂ú
                    const cleanValue = value.replace(/,/g, '');
                    party.auctionPrice = parseInt(cleanValue) || 0;
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                }
            }

            // Í≤ΩÎß§Ïû• Í∞ÄÍ≤© ÏûÖÎ†• Ïãú Ïã§ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ
            function formatAuctionPriceInput(input) {
                const value = input.value.replace(/,/g, '');
                const numValue = parseInt(value) || 0;
                input.value = addCommas(numValue);
                
                // ÏòÜÏóê ÏûàÎäî Îã®ÏúÑ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
                const unitDisplay = input.parentNode.querySelector('.auction-unit-display');
                if (unitDisplay) {
                    unitDisplay.textContent = formatToKoreanCurrency(numValue);
                }
            }

            // Ìó§Îçî ÌîåÎ†àÏù¥Ïñ¥Î™Ö Í∞ÄÏ†∏Ïò§Í∏∞
            function getHeaderPlayerNames() {
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                const playerNames = [];
                headerCells.forEach(cell => {
                    playerNames.push(cell.textContent.trim());
                });
                return playerNames;
            }

            // ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌååÌã∞Ïóê Ï∞∏Ïó¨ÌïòÎäîÏßÄ ÌôïÏù∏
            function isPlayerInParty(party, playerName) {
                if (!playerName) return false;
                
                const headerPlayers = getHeaderPlayerNames();
                const playerIndex = headerPlayers.indexOf(playerName);
                
                if (playerIndex === -1) return false;
                
                const characterSlot = party.characters[playerIndex];
                return characterSlot && characterSlot.trim() !== '';
            }

            // ÌîåÎ†àÏù¥Ïñ¥ ÌïÑÌÑ∞ÎßÅ
            function filterByPlayer(playerName) {
                currentPlayer = playerName.trim();
                applyFilters();
            }

            // Î≥¥Ïä§ ÌïÑÌÑ∞ÎßÅ
            function filterByBoss(bossName) {
                currentBoss = bossName.trim();
                applyFilters();
            }

            // ÌïÑÌÑ∞ Ï†ÅÏö©
            function applyFilters() {
                // Îëê ÌïÑÌÑ∞Í∞Ä Î™®Îëê ÎπÑÏñ¥ÏûàÏúºÎ©¥ ÌïÑÌÑ∞ Ìï¥Ï†ú
                if (currentPlayer === '' && currentBoss === '') {
                    filteredParties = null; // nullÎ°ú ÏÑ§Ï†ïÌïòÏó¨ ÌïÑÌÑ∞Í∞Ä ÏóÜÏùåÏùÑ ÌëúÏãú
                } else {
                    let tempFiltered = parties;
                    
                    // Î≥¥Ïä§ ÌïÑÌÑ∞ Ï†ÅÏö©
                    if (currentBoss !== '') {
                        tempFiltered = tempFiltered.filter(party => 
                            party.boss.toLowerCase().includes(currentBoss.toLowerCase())
                        );
                    }
                    
                    // ÌîåÎ†àÏù¥Ïñ¥ ÌïÑÌÑ∞ Ï†ÅÏö©
                    if (currentPlayer !== '') {
                        const playerParties = tempFiltered.filter(party => isPlayerInParty(party, currentPlayer));
                        const otherParties = tempFiltered.filter(party => !isPlayerInParty(party, currentPlayer));
                        tempFiltered = [...playerParties, ...otherParties];
                    }
                    
                    filteredParties = tempFiltered;
                }
                
                renderTable();
                saveFilterState();
            }

            // Ï†ÑÏ≤¥ ÌååÌã∞ Î≥¥Í∏∞
            function showAllParties() {
                filteredParties = null; // nullÎ°ú ÏÑ§Ï†ïÌïòÏó¨ ÌïÑÌÑ∞ Ìï¥Ï†ú
                currentPlayer = '';
                currentBoss = '';
                
                const playerFilterInput = document.getElementById('playerFilterInput');
                const bossFilterInput = document.getElementById('bossFilterInput');
                
                if (playerFilterInput) playerFilterInput.value = '';
                if (bossFilterInput) bossFilterInput.value = '';
                
                renderTable();
                saveFilterState();
            }

            // ÌîåÎ†àÏù¥Ïñ¥ ÌååÌã∞Îßå Î≥¥Í∏∞
            function showPlayerParties() {
                const inputValue = document.getElementById('playerFilterInput').value.trim();
                if (inputValue === '') {
                    alert('Î®ºÏ†Ä ÌîåÎ†àÏù¥Ïñ¥Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                currentPlayer = inputValue;
                const headerPlayers = getHeaderPlayerNames();
                
                if (headerPlayers.includes(currentPlayer)) {
                    filteredParties = parties.filter(party => isPlayerInParty(party, currentPlayer));
                } else {
                    alert('Ìó§ÎçîÏóê Îì±Î°ùÎêòÏßÄ ÏïäÏùÄ ÌîåÎ†àÏù¥Ïñ¥ÏûÖÎãàÎã§.');
                    filteredParties = [];
                }
                
                renderTable();
                saveFilterState();
            }

            // ÌÖåÏù¥Î∏î Î†åÎçîÎßÅ
            function renderTable() {
                const tbody = document.getElementById('partyTableBody');
                tbody.innerHTML = '';

                // ÎîîÎ≤ÑÍπÖ: parties Î∞∞Ïó¥ ÏÉÅÌÉú ÌôïÏù∏
                console.log('renderTable - parties length:', parties.length);
                console.log('renderTable - parties:', parties);

                let partiesToShow = filteredParties !== null ? filteredParties : parties;
                
                if (currentSort.column) {
                    partiesToShow = [...partiesToShow];
                    partiesToShow.sort((a, b) => {
                        let aVal, bVal;
                        
                        switch(currentSort.column) {
                            case 'boss':
                                aVal = a.boss || '';
                                bVal = b.boss || '';
                                break;
                            case 'day':
                                aVal = a.day || '';
                                bVal = b.day || '';
                                break;
                            case 'time':
                                aVal = a.time || '';
                                bVal = b.time || '';
                                break;
                            case 'cleared':
                                aVal = a.cleared ? 1 : 0;
                                bVal = b.cleared ? 1 : 0;
                                break;
                            case 'auctionPrice':
                                aVal = parseInt(a.auctionPrice) || 0;
                                bVal = parseInt(b.auctionPrice) || 0;
                                break;
                            case 'distribution':
                                aVal = calculateDistribution(a);
                                bVal = calculateDistribution(b);
                                break;
                            default:
                                return 0;
                        }

                        if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                        if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                        return 0;
                    });
                }

                partiesToShow.forEach(party => {
                    const row = document.createElement('div');
                    row.className = 'party-row';
                    row.setAttribute('data-party-id', party.id);
                    
                    const distributionAmount = calculateDistribution(party);
                    const participantCount = getParticipantCount(party);
                    
                    if (currentPlayer && isPlayerInParty(party, currentPlayer)) {
                        row.classList.add('player-party');
                    }
                    
                    if (party.cleared) {
                        row.classList.add('cleared-party');
                    }
                    
                    row.innerHTML = `
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="${party.id}" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: ${getBossColor(party.boss)}">
                            <input type="text" class="boss-input" value="${party.boss}" 
                                onchange="updateParty(${party.id}, 'boss', this.value)" 
                                placeholder="Î≥¥Ïä§Î™Ö">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[0] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_0_' + this.value)"
                                placeholder="${party.characters[0] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[0] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[1] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_1_' + this.value)"
                                placeholder="${party.characters[1] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[1] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[2] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_2_' + this.value)"
                                placeholder="${party.characters[2] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[2] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[3] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_3_' + this.value)"
                                placeholder="${party.characters[3] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[3] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[4] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_4_' + this.value)"
                                placeholder="${party.characters[4] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[4] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[5] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_5_' + this.value)"
                                placeholder="${party.characters[5] ? '' : 'Îπà Ïä¨Î°Ø'}"
                                style="${party.characters[5] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(${party.id}, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">ÏöîÏùº</option>
                                <option value="Ïõî" ${party.day === 'Ïõî' ? 'selected' : ''}>Ïõî</option>
                                <option value="Ìôî" ${party.day === 'Ìôî' ? 'selected' : ''}>Ìôî</option>
                                <option value="Ïàò" ${party.day === 'Ïàò' ? 'selected' : ''}>Ïàò</option>
                                <option value="Î™©" ${party.day === 'Î™©' ? 'selected' : ''}>Î™©</option>
                                <option value="Í∏à" ${party.day === 'Í∏à' ? 'selected' : ''}>Í∏à</option>
                                <option value="ÌÜ†" ${party.day === 'ÌÜ†' ? 'selected' : ''}>ÌÜ†</option>
                                <option value="Ïùº" ${party.day === 'Ïùº' ? 'selected' : ''}>Ïùº</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="${party.time || ''}" 
                                onchange="updateParty(${party.id}, 'time', this.value)"
                                placeholder="ÏãúÍ∞Ñ" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" ${party.cleared ? 'checked' : ''} 
                                onchange="toggleClear(${party.id})">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="${party.auctionPrice ? addCommas(party.auctionPrice) : ''}" 
                                onchange="updateAuctionPrice(${party.id}, this.value)"
                                oninput="formatAuctionPriceInput(this)"
                                placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">
                                ${party.auctionPrice ? formatToKoreanCurrency(party.auctionPrice) : '0Î©îÏÜå'}
                            </div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="ÏóëÏÖÄ Í≥µÏãù: Í≤ΩÎß§Ïû•ÌåêÎß§Í∞Ä ${party.auctionPrice ? party.auctionPrice.toLocaleString() : 0}Î©îÏÜå ‚Üí Í≤ΩÎß§Ïû•ÏàòÎ†πÍ∞Ä ${party.auctionPrice ? Math.round(party.auctionPrice * 0.97).toLocaleString() : 0}Î©îÏÜå ‚Üí NÎ™ÖÏã§ÏàòÎ†πÏï° ${party.auctionPrice && participantCount > 0 ? Math.round(Math.round(party.auctionPrice * 0.97) / (1 + (participantCount - 1) / 0.97)).toLocaleString() : 0}Î©îÏÜå ‚Üí Î∂ÑÎ∞∞Ïûê1Ïù∏ÎãπÏßÄÍ∏âÍ∏àÏï° ${distributionAmount.toLocaleString()}Î©îÏÜå">
                                ${distributionAmount.toLocaleString()}Î©îÏÜå
                            </div>
                        </div>
                    `;

                    tbody.appendChild(row);
                });

                updateSortHeaders();
                updateStats();
            }

            // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            function updateStats() {
                const partiesToShow = filteredParties !== null ? filteredParties : parties;
                const totalParties = partiesToShow.length;
                const clearedParties = partiesToShow.filter(p => p.cleared).length;
                
                const totalAuctionPrice = partiesToShow.reduce((sum, party) => sum + (party.auctionPrice || 0), 0);
                const totalDistribution = partiesToShow.reduce((sum, party) => {
                    const participantCount = getParticipantCount(party);
                    if (participantCount > 0) {
                        const distributionPerPerson = calculateDistribution(party);
                        return sum + (distributionPerPerson * participantCount);
                    }
                    return sum;
                }, 0);

                document.getElementById('totalParties').textContent = totalParties;
                document.getElementById('clearedParties').textContent = clearedParties;
                document.getElementById('totalAuctionPrice').textContent = totalAuctionPrice.toLocaleString() + 'Î©îÏÜå';
                document.getElementById('totalDistribution').textContent = totalDistribution.toLocaleString() + 'Î©îÏÜå';
            }

            // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            function saveData() {
                // ÌÅ¥Î¶¨Ïñ¥Îêú ÌååÌã∞Îì§ÏùÑ Îß® ÏïÑÎûòÎ°ú Ï†ïÎ†¨
                const sortedParties = [...parties].sort((a, b) => {
                    if (a.cleared && !b.cleared) return 1;
                    if (!a.cleared && b.cleared) return -1;
                    return 0;
                });
                
                const dataToSave = {
                    parties: sortedParties,
                    partyCounter: partyCounter,
                    headerData: (() => {
                        try {
                            const headerValues = [];
                            const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                            headerCells.forEach(cell => {
                                headerValues.push(cell.textContent.trim());
                            });
                            return headerValues;
                        } catch (error) {
                            console.error('Ìó§Îçî Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ïò§Î•ò:', error);
                            return [];
                        }
                    })(),
                    sortState: currentSort,
                    filterState: {
                        currentPlayer: currentPlayer,
                        currentBoss: currentBoss,
                        filteredParties: filteredParties
                    }
                };
                
                // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
                localStorage.setItem('maplePartyBossData', JSON.stringify(dataToSave));
                
                // Ï†ïÎ†¨Îêú ÌååÌã∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏
                parties = sortedParties;
                
                            // GitHub APIÍ∞Ä ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏúºÎ©¥ GitHubÏóêÎèÑ Ï†ÄÏû•
            if (githubConfig.enabled && githubConfig.token) {
                console.log('GitHubÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë...');
                // GitHub Ï†ÄÏû•ÏùÑ ÎπÑÎèôÍ∏∞Î°ú Ï≤òÎ¶¨ÌïòÎêò Ïò§Î•òÍ∞Ä Î∞úÏÉùÌï¥ÎèÑ Î°úÏª¨ Ï†ÄÏû•ÏùÄ Ïú†ÏßÄ
                saveDataToGitHub(dataToSave).catch(error => {
                    console.error('GitHub Ï†ÄÏû• Ïã§Ìå® (Î°úÏª¨ Ï†ÄÏû•ÏùÄ ÏôÑÎ£åÎê®):', error);
                });
            }
        }

            // Ìó§Îçî Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            function getHeaderData() {
                const headerValues = [];
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                headerCells.forEach(cell => {
                    headerValues.push(cell.textContent.trim());
                });
                return headerValues;
            }

            // Ìó§Îçî Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            function saveHeaderData() {
                const headerValues = getHeaderData();
                localStorage.setItem('maplePartyHeaderData', JSON.stringify(headerValues));
            }

            // Ï†ïÎ†¨ ÏÉÅÌÉú Ï†ÄÏû•
            function saveSortState() {
                localStorage.setItem('maplePartySortState', JSON.stringify(currentSort));
            }

            // ÌïÑÌÑ∞ ÏÉÅÌÉú Ï†ÄÏû•
            function saveFilterState() {
                const filterState = {
                    currentPlayer: currentPlayer,
                    currentBoss: currentBoss,
                    hasFilter: filteredParties !== null
                };
                localStorage.setItem('maplePartyFilterState', JSON.stringify(filterState));
            }

            // Î™®Îì† Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            async function saveAllData() {
                saveData();
                saveHeaderData();
                saveSortState();
                saveFilterState();
                renderTable(); // Ï†ÄÏû• ÌõÑ ÌÖåÏù¥Î∏î Îã§Ïãú Î†åÎçîÎßÅ
                
                // GitHub APIÎ•º ÌÜµÌïú Ï†ÄÏû• ÏãúÎèÑ
                if (githubConfig.enabled && githubConfig.token) {
                    try {
                        const success = await saveDataToGitHub();
                        if (success) {
                            alert('‚úÖ Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!\n\nüîó GitHubÏôÄ ÎèôÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.\n\nÎã§Î•∏ ÏÇ¨Ïö©ÏûêÎì§Ïù¥ ÏÉàÎ°úÍ≥†Ïπ®ÌïòÎ©¥ ÏµúÏã† Îç∞Ïù¥ÌÑ∞Î•º Î≥º Ïàò ÏûàÏäµÎãàÎã§.');
                            return;
                        }
                    } catch (error) {
                        console.error('GitHub Ï†ÄÏû• Ïã§Ìå®:', error);
                        alert('‚ö†Ô∏è GitHub Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\n\nÎ°úÏª¨ÏóêÎßå Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                    }
                }
                
                // GitHub APIÍ∞Ä ÎπÑÌôúÏÑ±ÌôîÎêú Í≤ΩÏö∞
                alert('‚úÖ Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Î°úÏª¨Ïóê Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
            }
            
            
            
            
            
            
            
            
            
            
            // GitHub API ÏÑ§Ï†ï
            function setupGitHubAPI() {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: white;
                        padding: 30px;
                        border-radius: 15px;
                        max-width: 600px;
                        width: 90%;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                    ">
                        <h3 style="margin-bottom: 20px; color: #4CAF50;">‚öôÔ∏è GitHub API ÏÑ§Ï†ï</h3>
                        <div style="margin-bottom: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border-left: 4px solid #4CAF50;">
                            <p style="margin: 0; font-weight: bold; color: #2e7d32;">üìã ÏÑ§Ï†ï Î∞©Î≤ï:</p>
                            <ol style="margin: 10px 0 0 20px; color: #2e7d32; font-size: 14px;">
                                <li>GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens</li>
                                <li>Generate new token (classic) ÌÅ¥Î¶≠</li>
                                <li>repo Í∂åÌïú Ï≤¥ÌÅ¨ ÌõÑ ÌÜ†ÌÅ∞ ÏÉùÏÑ±</li>
                                <li>ÏÉùÏÑ±Îêú ÌÜ†ÌÅ∞ÏùÑ ÏïÑÎûòÏóê ÏûÖÎ†•</li>
                            </ol>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">GitHub Personal Access Token:</label>
                            <input type="password" id="githubTokenInput" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #4CAF50;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                            ">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Ï†ÄÏû•ÏÜå ÏÜåÏú†Ïûê:</label>
                            <input type="text" id="githubOwnerInput" value="rlarhkd99-beep" readonly style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #ddd;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                                background-color: #f5f5f5;
                            ">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Ï†ÄÏû•ÏÜå Ïù¥Î¶Ñ:</label>
                            <input type="text" id="githubRepoInput" value="Maple" readonly style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #ddd;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                                background-color: #f5f5f5;
                            ">
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="testGitHubConnection()" style="
                                padding: 10px 20px;
                                background: #2196F3;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">üîó Ïó∞Í≤∞ ÌÖåÏä§Ìä∏</button>
                            <button onclick="saveGitHubConfig()" style="
                                padding: 10px 20px;
                                background: #4CAF50;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">üíæ ÏÑ§Ï†ï Ï†ÄÏû•</button>
                            <button onclick="this.closest('.modal').remove()" style="
                                padding: 10px 20px;
                                background: #f44336;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">Îã´Í∏∞</button>
                        </div>
                    </div>
                `;
                
                modal.className = 'modal';
                document.body.appendChild(modal);
                
                // Í∏∞Ï°¥ ÏÑ§Ï†ï Î°úÎìú
                loadGitHubConfig();
                
                // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
            }
            
            // GitHub ÏÑ§Ï†ï Î°úÎìú
            function loadGitHubConfig() {
                const saved = localStorage.getItem('githubConfig');
                if (saved) {
                    try {
                        githubConfig = JSON.parse(saved);
                        const tokenInput = document.getElementById('githubTokenInput');
                        if (tokenInput) {
                            tokenInput.value = githubConfig.token;
                        }
                    } catch (error) {
                        console.error('GitHub ÏÑ§Ï†ï Î°úÎìú Ïò§Î•ò:', error);
                    }
                }
            }
            
            // GitHub ÏÑ§Ï†ï Ï†ÄÏû•
            function saveGitHubConfig() {
                const tokenInput = document.getElementById('githubTokenInput');
                const ownerInput = document.getElementById('githubOwnerInput');
                const repoInput = document.getElementById('githubRepoInput');
                
                if (!tokenInput.value.trim()) {
                    alert('GitHub ÌÜ†ÌÅ∞ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                githubConfig.token = tokenInput.value.trim();
                githubConfig.owner = ownerInput.value.trim();
                githubConfig.repo = repoInput.value.trim();
                githubConfig.enabled = true;
                
                localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
                
                document.querySelector('.modal').remove();
                updateGitHubStatus();
                
                alert('‚úÖ GitHub API ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!\n\nÏù¥Ï†ú Îç∞Ïù¥ÌÑ∞Î•º GitHubÏôÄ ÎèôÍ∏∞ÌôîÌï† Ïàò ÏûàÏäµÎãàÎã§.');
            }
            
            // GitHub Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
            async function testGitHubConnection() {
                const tokenInput = document.getElementById('githubTokenInput');
                const ownerInput = document.getElementById('githubOwnerInput');
                const repoInput = document.getElementById('githubRepoInput');
                
                if (!tokenInput.value.trim()) {
                    alert('GitHub ÌÜ†ÌÅ∞ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                const testConfig = {
                    token: tokenInput.value.trim(),
                    owner: ownerInput.value.trim(),
                    repo: repoInput.value.trim()
                };
                
                try {
                    const response = await fetch(`https://api.github.com/repos/${testConfig.owner}/${testConfig.repo}`, {
                        headers: {
                            'Authorization': `token ${testConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        alert('‚úÖ GitHub Ïó∞Í≤∞ ÏÑ±Í≥µ!\n\nÏ†ÄÏû•ÏÜåÏóê Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    alert(`‚ùå GitHub Ïó∞Í≤∞ Ïã§Ìå®!\n\nÏò§Î•ò: ${error.message}\n\nÌÜ†ÌÅ∞Í≥º Ï†ÄÏû•ÏÜå Ï†ïÎ≥¥Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.`);
                    console.error('GitHub Ïó∞Í≤∞ Ïò§Î•ò:', error);
                }
            }
            
            // GitHub ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            function updateGitHubStatus() {
                const githubStatus = document.getElementById('githubStatus');
                if (githubStatus) {
                    if (githubConfig.enabled && githubConfig.token) {
                        githubStatus.innerHTML = 'üîó <strong>GitHub ÎèôÍ∏∞Ìôî ÌôúÏÑ±Ìôî</strong> - Îç∞Ïù¥ÌÑ∞Í∞Ä GitHubÏôÄ ÎèôÍ∏∞ÌôîÎê©ÎãàÎã§.';
                        githubStatus.style.color = '#4CAF50';
                    } else {
                        githubStatus.innerHTML = 'üíæ <strong>Î°úÏª¨ Î™®Îìú</strong> - GitHub APIÎ•º ÏÑ§Ï†ïÌïòÎ©¥ Îç∞Ïù¥ÌÑ∞Î•º Í≥µÏú†Ìï† Ïàò ÏûàÏäµÎãàÎã§.';
                        githubStatus.style.color = '#FF9800';
                    }
                }
            }
            
            // GitHubÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            async function loadDataFromGitHub() {
                if (!githubConfig.enabled || !githubConfig.token) {
                    return false;
                }
                
                try {
                    const response = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                        headers: {
                            'Authorization': `token ${githubConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        const fileData = await response.json();
                        
                        // Base64 ÎîîÏΩîÎî© Ïãú Ïù∏ÏΩîÎî© Î¨∏Ï†ú Ìï¥Í≤∞
                        const decodedContent = atob(fileData.content);
                        const jsonData = JSON.parse(decodedContent);
                        
                        console.log('GitHubÏóêÏÑú Î°úÎìúÎêú Îç∞Ïù¥ÌÑ∞:', jsonData);
                        console.log('GitHub Îç∞Ïù¥ÌÑ∞Ïùò parties:', jsonData.parties);
                        console.log('GitHub Îç∞Ïù¥ÌÑ∞Ïùò parties Í∏∏Ïù¥:', jsonData.parties ? jsonData.parties.length : 'undefined');
                        
                        // Ï≤´ Î≤àÏß∏ ÌååÌã∞Ïùò ÏÉÅÏÑ∏ ÎÇ¥Ïö© ÌôïÏù∏
                        if (jsonData.parties && jsonData.parties.length > 0) {
                            console.log('Ï≤´ Î≤àÏß∏ ÌååÌã∞ ÏÉÅÏÑ∏ ÎÇ¥Ïö©:', jsonData.parties[0]);
                            console.log('Ï≤´ Î≤àÏß∏ ÌååÌã∞Ïùò Î≥¥Ïä§:', jsonData.parties[0].boss);
                            console.log('Ï≤´ Î≤àÏß∏ ÌååÌã∞Ïùò Ï∫êÎ¶≠ÌÑ∞Îì§:', jsonData.parties[0].characters);
                        }
                        
                        // Ïù∏ÏΩîÎî© Î¨∏Ï†úÍ∞Ä ÏûàÎäî Í≤ΩÏö∞ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                        if (!jsonData.parties || jsonData.parties.length === 0) {
                            console.log('GitHub Îç∞Ïù¥ÌÑ∞Ïóê Î¨∏Ï†úÍ∞Ä ÏûàÏñ¥ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.');
                            return false;
                        }
                        
                        loadSharedData(jsonData);
                        return true;
                    } else if (response.status === 404) {
                        console.log('GitHubÏóê Îç∞Ïù¥ÌÑ∞ ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§. Î°úÏª¨ Îç∞Ïù¥ÌÑ∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.');
                        return false;
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:', error);
                    return false;
                }
            }
            
            // GitHubÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            async function saveDataToGitHub() {
                if (!githubConfig.enabled || !githubConfig.token) {
                    return false;
                }
                
                try {
                    const currentHeaderData = getHeaderPlayerNames();
                    
                    const shareData = {
                        parties: parties,
                        partyCounter: partyCounter,
                        headerData: currentHeaderData,
                        sortState: currentSort,
                        filterState: {
                            currentPlayer: currentPlayer,
                            currentBoss: currentBoss,
                            filteredParties: filteredParties ? filteredParties.map(p => p.id) : null
                        },
                        lastUpdated: new Date().toISOString()
                    };
                    
                    const jsonString = JSON.stringify(shareData, null, 2);
                    const encodedContent = btoa(unescape(encodeURIComponent(jsonString)));
                    
                    // Í∏∞Ï°¥ ÌååÏùº Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
                    let sha = null;
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                            headers: {
                                'Authorization': `token ${githubConfig.token}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        });
                        
                        if (getResponse.ok) {
                            const fileData = await getResponse.json();
                            sha = fileData.sha;
                        }
                    } catch (error) {
                        console.log('Í∏∞Ï°¥ ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§. ÏÉàÎ°ú ÏÉùÏÑ±Ìï©ÎãàÎã§.');
                    }
                    
                    // ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏/ÏÉùÏÑ±
                    const updateResponse = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${githubConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `Î©îÏù¥Ìîå ÌååÌã∞Î≥¥Ïä§ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ - ${new Date().toLocaleString()}`,
                            content: encodedContent,
                            sha: sha
                        })
                    });
                    
                    if (updateResponse.ok) {
                        console.log('GitHubÏóê Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                        return true;
                    } else {
                        throw new Error(`HTTP ${updateResponse.status}: ${updateResponse.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ïò§Î•ò:', error);
                    return false;
                }
            }

            // ÏöîÏùº ÏùºÍ¥Ñ ÏÇ≠Ï†ú
            function clearAllDays() {
                if (confirm('Î™®Îì† ÌååÌã∞Ïùò ÏöîÏùºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    parties.forEach(party => {
                        party.day = '';
                    });
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                    alert('Î™®Îì† ÌååÌã∞Ïùò ÏöîÏùºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            // ÏãúÍ∞Ñ ÏùºÍ¥Ñ ÏÇ≠Ï†ú
            function clearAllTimes() {
                if (confirm('Î™®Îì† ÌååÌã∞Ïùò ÏãúÍ∞ÑÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    parties.forEach(party => {
                        party.time = '';
                    });
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                    alert('Î™®Îì† ÌååÌã∞Ïùò ÏãúÍ∞ÑÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            // ÌÅ¥Î¶¨Ïñ¥ ÏùºÍ¥Ñ Ìï¥Ï†ú
            function clearAllCleared() {
                if (confirm('Î™®Îì† ÌååÌã∞Ïùò ÌÅ¥Î¶¨Ïñ¥ ÏÉÅÌÉúÎ•º Ìï¥Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    parties.forEach(party => {
                        party.cleared = false;
                    });
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                    alert('Î™®Îì† ÌååÌã∞Ïùò ÌÅ¥Î¶¨Ïñ¥ ÏÉÅÌÉúÍ∞Ä Ìï¥Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            // Í≤ΩÎß§Ïû• ÌåêÎß§Í∞Ä ÏùºÍ¥Ñ ÏÇ≠Ï†ú
            function clearAllAuctionPrices() {
                if (confirm('Î™®Îì† ÌååÌã∞Ïùò Í≤ΩÎß§Ïû• ÌåêÎß§Í∞ÄÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    parties.forEach(party => {
                        party.auctionPrice = 0;
                    });
                    saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                    renderTable();
                    alert('Î™®Îì† ÌååÌã∞Ïùò Í≤ΩÎß§Ïû• ÌåêÎß§Í∞ÄÍ∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                }
            }

            // ÌååÏùºÎ°ú Ï†ÄÏû•
            function saveAsFile() {
                const currentHeaderData = getHeaderPlayerNames();
                
                const currentData = {
                    parties: parties,
                    partyCounter: partyCounter,
                    headerData: currentHeaderData,
                    sortState: currentSort,
                    filterState: {
                        currentPlayer: currentPlayer,
                        currentBoss: currentBoss,
                        filteredParties: filteredParties ? filteredParties.map(p => p.id) : null
                    }
                };
                
                const htmlContent = generateHTMLWithData(currentData);
                
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Î©îÏù¥Ìîå_ÌååÌã∞Î≥¥Ïä§_Í¥ÄÎ¶¨_${new Date().toISOString().split('T')[0]}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                const shareUrl = generateShareUrl();
                alert(`ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Í∞Ä Ìè¨Ìï®Îêú HTML ÌååÏùºÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!\n\nÍ≥µÏú† URL: ${shareUrl}\n\nÏù¥ URLÏùÑ Îã§Î•∏ ÏÇ¨ÎûåÎì§Í≥º Í≥µÏú†ÌïòÎ©¥ Í∞ôÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Î≥º Ïàò ÏûàÏäµÎãàÎã§.`);
            }

            // HTML ÏÉùÏÑ±
            function generateHTMLWithData(data) {
                const currentHTML = document.documentElement.outerHTML;
                
                const startMarker = 'const EMBEDDED_DATA = {';
                const endMarker = '};';
                
                const startIndex = currentHTML.indexOf(startMarker);
                const endIndex = currentHTML.indexOf(endMarker, startIndex) + endMarker.length;
                
                if (startIndex === -1 || endIndex === -1) {
                    return currentHTML;
                }
                
                const newEmbeddedData = `const EMBEDDED_DATA = ${JSON.stringify(data, null, 4)};`;
                const newHTML = currentHTML.substring(0, startIndex) + newEmbeddedData + currentHTML.substring(endIndex);
                
                return newHTML;
            }




        </script>


    </body></html>
