
    <html lang="ko"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>메이플 파티보스 관리</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                overflow: hidden;
            }

            .header {
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                color: white;
                padding: 30px;
                text-align: center;
            }

            .header h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }

            .controls {
                background: #f8f9fa;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                align-items: center;
            }

            .btn {
                padding: 12px 20px;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-weight: bold;
                transition: all 0.3s ease;
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .btn-primary {
                background: #4CAF50;
                color: white;
            }

            .btn-primary:hover {
                background: #45a049;
                transform: translateY(-2px);
            }

            .btn-danger {
                background: #f44336;
                color: white;
            }

            .btn-danger:hover {
                background: #da190b;
                transform: translateY(-2px);
            }

            .filter-section {
                background: #e8f5e8;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
            }

            .filter-section h3 {
                color: #2e7d32;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .filter-controls {
                display: flex;
                gap: 15px;
                align-items: center;
                flex-wrap: wrap;
            }

            .filter-group {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .filter-group label {
                font-weight: bold;
                color: #2e7d32;
                white-space: nowrap;
            }

            .filter-input {
                padding: 10px 15px;
                border: 2px solid #4CAF50;
                border-radius: 8px;
                font-size: 16px;
                min-width: 250px;
            }

            .filter-input:focus {
                outline: none;
                border-color: #2e7d32;
                box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
            }

            .table-container {
                overflow-x: hidden;
                background: white;
                max-width: 100%;
            }

            .table-header {
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                color: white;
                display: grid;
                grid-template-columns: 35px 120px repeat(6, 90px) 70px 90px 70px 120px 100px;
                gap: 1px;
                font-weight: bold;
                text-align: center;
                padding: 12px 0;
            }

            .table-header div {
                padding: 8px 4px;
                cursor: pointer;
                transition: background-color 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 13px;
                position: relative;
            }

            .table-header div:hover {
                background: rgba(255,255,255,0.1);
            }

            .table-header div.sortable::after {
                content: ' ↕';
                opacity: 0.5;
            }

            .table-header div.sorted-asc::after {
                content: ' ↑';
                opacity: 1;
            }

            .table-header div.sorted-desc::after {
                content: ' ↓';
                opacity: 1;
            }

            .party-row {
                display: grid;
                grid-template-columns: 35px 120px repeat(6, 90px) 70px 90px 70px 120px 100px;
                gap: 1px;
                border-bottom: 1px solid #dee2e6;
                transition: background-color 0.3s ease;
            }

            .party-row:hover {
                background: #f8f9fa;
            }

            .party-row.player-party {
                background: #e3f2fd;
            }

            .party-row.cleared-party {
                background: #f5f5f5;
                opacity: 0.6;
                color: #999;
            }

            .party-row.cleared-party .boss-cell {
                opacity: 0.7;
            }

            .party-row.cleared-party input,
            .party-row.cleared-party select {
                background-color: #f8f8f8;
                color: #999;
                border-color: #ddd;
            }

            .party-row.cleared-party .distribution-amount {
                color: #999;
            }

            .party-row > div {
                padding: 8px 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 40px;
            }

            .boss-cell {
                background: var(--boss-color, #4CAF50);
                color: white;
                border-radius: 5px;
                margin: 2px;
            }

            .boss-input, .character-input, .time-input, .auction-input {
                width: 100%;
                padding: 8px 6px;
                border: 1px solid #ddd;
                border-radius: 4px;
                text-align: center;
                font-size: 13px;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }

            .boss-input:focus, .character-input:focus, .time-input:focus, .auction-input:focus {
                outline: none;
                border-color: #4CAF50;
                box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
            }

            .character-input:placeholder-shown {
                background-color: #f8f9fa;
                color: #adb5bd;
                border-color: #e9ecef;
            }

            .character-input:placeholder-shown::placeholder {
                color: #adb5bd;
                font-size: 12px;
            }

            .clear-checkbox {
                width: 20px;
                height: 20px;
                cursor: pointer;
            }

            .distribution-amount {
                font-weight: bold;
                color: #2e7d32;
                cursor: help;
            }

            .stats-container {
                background: #f8f9fa;
                padding: 20px;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
            }

            .stat-item {
                background: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .stat-number {
                font-size: 2em;
                font-weight: bold;
                color: #4CAF50;
                margin-bottom: 5px;
            }

            .stat-label {
                color: #666;
                font-size: 0.9em;
            }

            .player-info {
                margin-top: 15px;
                padding: 15px;
                background: #f0f8f0;
                border-radius: 8px;
                border-left: 4px solid #4CAF50;
            }

            .player-info small {
                color: #2e7d32;
                display: block;
                margin-bottom: 5px;
            }

            .bulk-actions-section {
                background: #fff3cd;
                padding: 20px;
                border-bottom: 1px solid #dee2e6;
            }

            .bulk-actions-section h3 {
                color: #856404;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .bulk-actions {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                align-items: center;
            }

            .bulk-actions .btn {
                font-size: 14px;
                padding: 10px 15px;
            }

            @media (max-width: 1200px) {
                .table-header, .party-row {
                    grid-template-columns: 30px 100px repeat(6, 80px) 60px 80px 60px 100px 90px;
                }
            }

            @media (max-width: 768px) {
                .controls {
                    flex-direction: column;
                    align-items: stretch;
                }
                
                .btn {
                    margin: 5px 0;
                    padding: 12px 20px;
                    font-size: 14px;
                }
                
                .bulk-actions {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 8px;
                }
                
                .bulk-actions .btn {
                    margin: 2px 0;
                    padding: 10px 15px;
                    font-size: 13px;
                }
                
                .filter-controls {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 10px;
                }
                
                .filter-group {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 5px;
                }
                
                .filter-group label {
                    font-size: 14px;
                    margin-bottom: 5px;
                }
                
                .filter-input {
                    min-width: auto;
                    font-size: 16px; /* 모바일에서 줌 방지 */
                    padding: 12px 15px;
                }
                
                .table-header, .party-row {
                    grid-template-columns: 25px 80px repeat(6, 60px) 50px 60px 50px 80px 70px;
                    font-size: 11px;
                }
                
                .boss-input, .character-input, .time-input, .auction-input {
                    font-size: 12px;
                    padding: 6px 4px;
                }
                
                .table-header div {
                    padding: 6px 2px;
                    font-size: 11px;
                }
                
                .party-row > div {
                    padding: 6px 2px;
                    min-height: 35px;
                }
                
                .party-checkbox {
                    width: 14px !important;
                    height: 14px !important;
                    -webkit-tap-highlight-color: transparent;
                }
                
                /* 모바일에서 터치 영역 확대 */
                .table-header div, .party-row > div {
                    min-height: 44px; /* iOS 권장 터치 영역 */
                }
                
                /* 모바일에서 스크롤 개선 */
                .table-container {
                    -webkit-overflow-scrolling: touch;
                }
                
                .stats {
                    flex-direction: column;
                    gap: 10px;
                }
                
                .stat-item {
                    text-align: center;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>🎮 메이플 파티보스 관리</h1>
                <p>파티 관리 &amp; 분배금 계산</p>
                <div id="githubStatus" style="margin-top: 5px; font-size: 12px; opacity: 0.8;"></div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="addParty()">
                    ➕ 새 파티 추가
                </button>
                <button class="btn btn-primary" onclick="saveAllData()">
                    💾 저장
                </button>
                <button class="btn btn-primary" onclick="setupGitHubAPI()">
                    ⚙️ GitHub API 설정
                </button>
                <button class="btn btn-primary" onclick="saveAsFile()">
                    📁 파일로 저장
                </button>
                <button class="btn btn-danger" onclick="deleteSelectedParties()">
                    ✅ 선택된 파티 삭제
                </button>
                <button class="btn btn-danger" onclick="clearAllParties()">
                    🗑️ 모든 파티 삭제
                </button>
            </div>

            <div class="filter-section">
                <h3>🔍 파티 필터</h3>
                <div class="filter-controls">
                    <div class="filter-group">
                        <label>플레이어:</label>
                        <input type="text" id="playerFilterInput" class="filter-input" placeholder="플레이어명 입력..." onkeyup="filterByPlayer(this.value)" onblur="filterByPlayer(this.value)" title="플레이어명을 입력하면 해당 플레이어가 참여하는 파티를 우선적으로 보여줍니다">
                    </div>
                    <div class="filter-group">
                        <label>보스:</label>
                        <input type="text" id="bossFilterInput" class="filter-input" placeholder="보스명 입력..." onkeyup="filterByBoss(this.value)" onblur="filterByBoss(this.value)" title="보스명을 입력하면 해당 보스 파티만 보여줍니다">
                    </div>
                    <button class="btn btn-primary" onclick="showAllParties()" title="모든 파티를 표시합니다">
                        👥 전체 보기
                    </button>
                    <button class="btn btn-primary" onclick="showPlayerParties()" title="입력한 플레이어가 참여하는 파티만 표시합니다">
                        🎯 플레이어 파티만 보기
                    </button>
                </div>
                <div class="player-info">
                    <small>💡 플레이어명을 입력하면 해당 플레이어가 참여하는 파티를 우선적으로 보여줍니다.</small>
                </div>
            </div>

            <div class="bulk-actions-section">
                <h3>🗑️ 일괄 삭제</h3>
                <div class="bulk-actions">
                    <button class="btn btn-danger" onclick="clearAllDays()" title="모든 파티의 요일을 삭제합니다">
                        📅 요일 일괄 삭제
                    </button>
                    <button class="btn btn-danger" onclick="clearAllTimes()" title="모든 파티의 시간을 삭제합니다">
                        ⏰ 시간 일괄 삭제
                    </button>
                    <button class="btn btn-danger" onclick="clearAllCleared()" title="모든 파티의 클리어 상태를 해제합니다">
                        ✅ 클리어 일괄 해제
                    </button>
                    <button class="btn btn-danger" onclick="clearAllAuctionPrices()" title="모든 파티의 경매장 판매가를 삭제합니다">
                        💰 경매장 판매가 일괄 삭제
                    </button>
                </div>
            </div>

            <div class="table-container">
                <div class="table-header" id="tableHeader">
                    <div>
                        <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                    </div>
                    <div class="sortable" onclick="sortTable('boss')">보스</div>
                    <div class="header-input" data-index="0" contenteditable="true" onblur="updateHeader(0, this.textContent)">창호</div>
                    <div class="header-input" data-index="1" contenteditable="true" onblur="updateHeader(1, this.textContent)">광민</div>
                    <div class="header-input" data-index="2" contenteditable="true" onblur="updateHeader(2, this.textContent)">태훈</div>
                    <div class="header-input" data-index="3" contenteditable="true" onblur="updateHeader(3, this.textContent)">은규</div>
                    <div class="header-input" data-index="4" contenteditable="true" onblur="updateHeader(4, this.textContent)">준수</div>
                    <div class="header-input" data-index="5" contenteditable="true" onblur="updateHeader(5, this.textContent)">지훈</div>
                    <div class="sortable" onclick="sortTable('day')">요일</div>
                    <div class="sortable" onclick="sortTable('time')">시간</div>
                    <div class="sortable" onclick="sortTable('cleared')">클리어</div>
                    <div class="sortable" onclick="sortTable('auctionPrice')">경매장 판매가</div>
                    <div class="sortable" onclick="sortTable('distribution')">분배금</div>
                </div>
                <div id="partyTableBody"><div class="party-row player-party" data-party-id="1">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="1" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="이지 카링" onchange="updateParty(1, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="보마" onchange="updateParty(1, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="에반" onchange="updateParty(1, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(1, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(1, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(1, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(1)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(1, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="2">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="2" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #4ECDC4">
                            <input type="text" class="boss-input" value="익스 스우" onchange="updateParty(2, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="보마" onchange="updateParty(2, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="비숍" onchange="updateParty(2, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(2, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(2, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(2, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(2)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(2, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="3">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="3" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="이지 카링" onchange="updateParty(3, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_0_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="비숍" onchange="updateParty(3, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="히어로" onchange="updateParty(3, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(3, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(3, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(3, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(3)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(3, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="5">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="5" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="이지 대적자" onchange="updateParty(5, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="은월" onchange="updateParty(5, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="불독" onchange="updateParty(5, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(5, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(5, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(5, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(5)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(5, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="7">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="7" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="하드 세렌" onchange="updateParty(7, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_0_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="불독" onchange="updateParty(7, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="윈브" onchange="updateParty(7, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(7, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(7, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금" selected="">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(7, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(7)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(7, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row player-party" data-party-id="8">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="8" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="이지 칼로스" onchange="updateParty(8, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_0_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="불독" onchange="updateParty(8, 'characters', 'char_1_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="윈브" onchange="updateParty(8, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(8, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(8, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금" selected="">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(8, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(8)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(8, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="4">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="4" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="하드 세렌" onchange="updateParty(4, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="은월" onchange="updateParty(4, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="히어로" onchange="updateParty(4, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(4, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(4, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(4, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(4)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(4, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="6">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="6" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="이지 카링" onchange="updateParty(6, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="은월" onchange="updateParty(6, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="아델" onchange="updateParty(6, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(6, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(6, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(6, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(6)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(6, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="9">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="9" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="하드 세렌" onchange="updateParty(9, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="아란" onchange="updateParty(9, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="신궁" onchange="updateParty(9, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="비숍" onchange="updateParty(9, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(9, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(9, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(9, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(9)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(9, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="10">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="10" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="이지 대적자" onchange="updateParty(10, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="아란" onchange="updateParty(10, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="신궁" onchange="updateParty(10, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(10, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(10, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(10, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(10)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(10, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="11">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="11" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="이지 칼로스" onchange="updateParty(11, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="아란" onchange="updateParty(11, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="신궁" onchange="updateParty(11, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(11, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(11, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(11, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(11)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(11, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="12">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="12" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FF6B6B">
                            <input type="text" class="boss-input" value="이지 카링" onchange="updateParty(12, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="아란" onchange="updateParty(12, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="신궁" onchange="updateParty(12, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="제로" onchange="updateParty(12, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(12, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(12, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(12, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(12)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(12, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="13">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="13" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="하드 세렌" onchange="updateParty(13, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="썬콜" onchange="updateParty(13, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="패파" onchange="updateParty(13, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="제로" onchange="updateParty(13, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(13, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(13, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(13, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(13)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(13, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="14">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="14" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="이지 대적자" onchange="updateParty(14, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="썬콜" onchange="updateParty(14, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="패파" onchange="updateParty(14, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="제로" onchange="updateParty(14, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(14, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(14, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(14, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(14)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(14, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="15">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="15" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="이지 칼로스" onchange="updateParty(15, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="썬콜" onchange="updateParty(15, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="패파" onchange="updateParty(15, 'characters', 'char_2_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="제로" onchange="updateParty(15, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(15, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(15, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(15, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(15)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(15, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="16">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="16" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #4ECDC4">
                            <input type="text" class="boss-input" value="익스 스우" onchange="updateParty(16, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="불독" onchange="updateParty(16, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="히어로" onchange="updateParty(16, 'characters', 'char_3_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_4_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(16, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(16, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(16, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(16)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(16, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="17">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="17" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #45B7D1">
                            <input type="text" class="boss-input" value="하드 세렌" onchange="updateParty(17, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(17, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(17, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(17, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(17, 'characters', 'char_5_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(17, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(17, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(17)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(17, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="18">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="18" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #96CEB4">
                            <input type="text" class="boss-input" value="이지 대적자" onchange="updateParty(18, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(18, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(18, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(18, 'characters', 'char_5_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(18, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(18, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(18)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(18, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div><div class="party-row" data-party-id="19">
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="19" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: #FFEAA7">
                            <input type="text" class="boss-input" value="이지 칼로스" onchange="updateParty(19, 'boss', this.value)" placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(19, 'characters', 'char_0_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_1_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_2_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="" onchange="updateParty(19, 'characters', 'char_3_' + this.value)" placeholder="빈 슬롯" style="background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(19, 'characters', 'char_4_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="렌" onchange="updateParty(19, 'characters', 'char_5_' + this.value)" placeholder="" style="">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(19, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월">월</option>
                                <option value="화">화</option>
                                <option value="수">수</option>
                                <option value="목">목</option>
                                <option value="금">금</option>
                                <option value="토">토</option>
                                <option value="일">일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="" onchange="updateParty(19, 'time', this.value)" placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" onchange="toggleClear(19)">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="" onchange="updateAuctionPrice(19, this.value)" oninput="formatAuctionPriceInput(this)" placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">0메소</div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 0메소 → 경매장수령가 0메소 → N명실수령액 0메소 → 분배자1인당지급금액 0메소">
                                0메소
                            </div>
                        </div>
                    </div></div>
            </div>

            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-number" id="totalParties">19</div>
                    <div class="stat-label">총 파티 수</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="clearedParties">0</div>
                    <div class="stat-label">클리어한 파티</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalAuctionPrice">0메소</div>
                    <div class="stat-label">총 경매장 판매가</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalDistribution">0메소</div>
                    <div class="stat-label">총 분배 가능 금액</div>
                </div>
            </div>
        </div>

        <script>
            // 전역 변수
            let parties = [];
            let partyCounter = 1;
            let currentSort = { column: null, direction: 'asc' };
            let currentPlayer = '';
            let currentBoss = '';
            let filteredParties = null; // null = 필터 없음, 배열 = 필터 적용됨
            
            // GitHub API 설정 (일시적으로 비활성화)
            let githubConfig = {
                token: '',
                owner: 'rlarhkd99-beep',
                repo: 'Maple',
                filePath: 'data/maple_party_data.json',
                enabled: true // GitHub API 활성화
            };

            // 보스별 색상 매핑
            const bossColors = {
                '이지 카링': '#FF6B6B',
                '익스 스우': '#4ECDC4',
                '하드 세렌': '#45B7D1',
                '이지 대적자': '#96CEB4',
                '이지 칼로스': '#FFEAA7',
                '하드 카링': '#DDA0DD',
                '익스 카링': '#98D8C8',
                '하드 스우': '#F7DC6F',
                '익스 세렌': '#BB8FCE',
                '하드 대적자': '#85C1E9',
                '익스 대적자': '#F8C471',
                '하드 칼로스': '#82E0AA',
                '익스 칼로스': '#F1948A'
            };

            // 기본 데이터는 DOMContentLoaded에서 정의됨

            // 초기화
            document.addEventListener('DOMContentLoaded', function() {
                // EMBEDDED_DATA 정의
                window.EMBEDDED_DATA = {
        "parties": [
            {
                "id": 1,
                "characters": [
                    "보마",
                    "에반",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "이지 카링",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 2,
                "characters": [
                    "보마",
                    "비숍",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "익스 스우",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 3,
                "characters": [
                    "",
                    "비숍",
                    "",
                    "히어로",
                    "",
                    ""
                ],
                "boss": "이지 카링",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 4,
                "characters": [
                    "은월",
                    "",
                    "",
                    "히어로",
                    "",
                    ""
                ],
                "boss": "하드 세렌",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 5,
                "characters": [
                    "은월",
                    "불독",
                    "",
                    "",
                    "",
                    ""
                ],
                "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 6,
                "characters": [
                    "은월",
                    "",
                    "",
                    "",
                    "아델",
                    ""
                ],
                "boss": "이지 카링",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 7,
                "characters": [
                    "",
                    "불독",
                    "",
                    "윈브",
                    "",
                    ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                            "auctionPrice": 0
            },
            {
                "id": 8,
                "characters": [
                                "은월",
                    "",
                    "",
                    "",
                                "",
                                "아델"
                ],
                            "boss": "이지 카링",
                "time": "",
                "cleared": false,
                            "auctionPrice": 0
            },
            {
                "id": 9,
                "characters": [
                    "",
                                "불독",
                    "",
                                "",
                                "아델",
                    ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 10,
                "characters": [
                                "은월",
                    "",
                    "",
                    "",
                                "",
                                "아델"
                ],
                "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 11,
                "characters": [
                    "",
                                "불독",
                    "",
                    "",
                                "아델",
                    ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 12,
                "characters": [
                                "은월",
                    "",
                    "",
                                "",
                                "",
                                "아델"
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 13,
                "characters": [
                    "",
                                "불독",
                    "",
                                "",
                                "아델",
                    ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 14,
                "characters": [
                                "은월",
                    "",
                    "",
                                "",
                                "",
                                "아델"
                ],
                "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 15,
                "characters": [
                    "",
                                "불독",
                    "",
                                "",
                                "아델",
                    ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 16,
                "characters": [
                                "은월",
                    "",
                    "",
                    "",
                                "",
                                "아델"
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 17,
                "characters": [
                    "",
                                "불독",
                    "",
                    "",
                                "아델",
                                ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 18,
                "characters": [
                                "은월",
                    "",
                    "",
                    "",
                                "",
                                "아델"
                ],
                "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            },
            {
                "id": 19,
                "characters": [
                    "",
                                "불독",
                    "",
                    "",
                                "아델",
                                ""
                ],
                            "boss": "이지 대적자",
                "time": "",
                "cleared": false,
                "auctionPrice": 0
            }
        ],
        "partyCounter": 20,
        "headerData": [
            "창호",
            "광민",
            "태훈",
            "은규",
            "준수",
            "지훈"
                    ]
                };
                
                // EMBEDDED_DATA 정의 후 데이터 로드
                loadData();
            });

            // 키보드 단축키 (Ctrl+S로 저장)
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    saveAllData();
                }
            });

            // 데이터 로드
            function loadData() {
                console.log('loadData 시작');
                
                // EMBEDDED_DATA에서 19개 파티 데이터 사용
                if (window.EMBEDDED_DATA && window.EMBEDDED_DATA.parties) {
                    // 전역 변수에 명시적으로 할당
                    window.parties = [...window.EMBEDDED_DATA.parties];
                    window.partyCounter = window.EMBEDDED_DATA.partyCounter;
                    
                    // 기존 변수에도 할당
                    parties = window.parties;
                    partyCounter = window.partyCounter;
                    
                    console.log('loadData - EMBEDDED_DATA에서 로드:', parties.length, '개');
                    console.log('loadData - 첫 번째 파티:', parties[0]);
                    console.log('loadData - parties 배열 전체:', parties);
                } else {
                    console.error('EMBEDDED_DATA가 정의되지 않았습니다.');
                    return;
                }
                
                // 데이터 저장
                saveData();
                
                // 테이블 렌더링
                renderTable();
            }
            
            // 공유 데이터 로드
            function loadSharedData(data) {
                console.log('loadSharedData - 받은 데이터:', data);
                console.log('loadSharedData - data.parties:', data.parties);
                
                        parties = data.parties || [];
                        partyCounter = data.partyCounter || 1;
                        
                console.log('loadSharedData - parties 설정 후:', parties);
                console.log('loadSharedData - parties.length:', parties.length);
                
                // 공유된 데이터를 로컬에도 저장
                saveData();
                
                // 헤더 데이터도 복원
                if (data.headerData) {
                    const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                    data.headerData.forEach((value, index) => {
                        if (headerCells[index]) {
                            headerCells[index].textContent = value;
                        }
                    });
                    saveHeaderData();
                }
                
                // 정렬 상태 복원
                if (data.sortState) {
                    currentSort = data.sortState;
                    saveSortState();
                }
                
                // 필터 상태 복원
                if (data.filterState) {
                    currentPlayer = data.filterState.currentPlayer || '';
                    currentBoss = data.filterState.currentBoss || '';
                    
                    const playerFilterInput = document.getElementById('playerFilterInput');
                    const bossFilterInput = document.getElementById('bossFilterInput');
                    
                    if (playerFilterInput) playerFilterInput.value = currentPlayer;
                    if (bossFilterInput) bossFilterInput.value = currentBoss;
                    
                    if (data.filterState.filteredParties) {
                        filteredParties = parties.filter(p => data.filterState.filteredParties.includes(p.id));
                    }
                    saveFilterState();
                }
                
                console.log('공유된 데이터를 성공적으로 로드했습니다.');
                
                // 공유된 데이터 로드 알림
                setTimeout(() => {
                    alert('🔗 공유된 데이터를 성공적으로 로드했습니다!\n\n이제 다른 사용자와 같은 데이터를 공유하고 있습니다.');
                }, 500);
            }
            
            // GitHub 또는 로컬에서 데이터 로드
            async function loadFromGitHubOrLocal() {
                // GitHub API 설정 로드
                loadGitHubConfig();
                updateGitHubStatus();
                
                // GitHub API가 활성화되어 있고 토큰이 있으면 GitHub에서 로드
                if (githubConfig.enabled && githubConfig.token) {
                    console.log('GitHub API를 사용하여 데이터를 로드합니다.');
                    const success = await loadDataFromGitHub();
                    if (success) {
                        console.log('GitHub에서 데이터 로드 성공');
                        return;
                } else {
                        console.log('GitHub에서 데이터 로드 실패, 로컬 데이터 사용');
                    }
                }
                
                // GitHub API가 비활성화되었거나 실패한 경우 로컬 데이터 사용
                console.log('로컬 데이터를 사용합니다.');
                loadFromLocalStorage();
            }
            
            // 로컬 스토리지에서 데이터 로드
            function loadFromLocalStorage() {
                // EMBEDDED_DATA가 정의되었는지 확인
                if (!window.EMBEDDED_DATA) {
                    console.error('EMBEDDED_DATA가 정의되지 않았습니다.');
                    return;
                }
                
                console.log('loadFromLocalStorage - EMBEDDED_DATA 확인:', window.EMBEDDED_DATA);
                console.log('loadFromLocalStorage - EMBEDDED_DATA.parties:', window.EMBEDDED_DATA.parties);
                
                // 강제로 기본 데이터 사용
                console.log('loadFromLocalStorage - 강제로 기본 데이터 사용');
                parties = [...window.EMBEDDED_DATA.parties];
                partyCounter = window.EMBEDDED_DATA.partyCounter;
                
                console.log('loadFromLocalStorage - 기본 데이터 로드 완료:', parties.length, '개');
                console.log('loadFromLocalStorage - 첫 번째 파티:', parties[0]);
                
                // 기본 데이터 저장
                saveData();
                
                filteredParties = null;
                loadHeaderData();
                loadSortState();
                loadFilterState();
            }

            // 헤더 데이터 로드
            function loadHeaderData() {
                const saved = localStorage.getItem('maplePartyHeaderData');
                
                if (saved) {
                    try {
                        const headerValues = JSON.parse(saved);
                        const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                        headerValues.forEach((value, index) => {
                            if (headerCells[index]) {
                                headerCells[index].textContent = value;
                            }
                        });
                    } catch (error) {
                        console.error('헤더 데이터 파싱 오류:', error);
                        loadDefaultHeaders();
                    }
                } else {
                    loadDefaultHeaders();
                }
            }

            // 기본 헤더 로드
            function loadDefaultHeaders() {
                const defaultHeaders = window.EMBEDDED_DATA.headerData;
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                defaultHeaders.forEach((value, index) => {
                    if (headerCells[index]) {
                        headerCells[index].textContent = value;
                    }
                });
                localStorage.setItem('maplePartyHeaderData', JSON.stringify(defaultHeaders));
            }

            // 정렬 상태 로드
            function loadSortState() {
                const saved = localStorage.getItem('maplePartySortState');
                if (saved) {
                    try {
                        currentSort = JSON.parse(saved);
                    } catch (error) {
                        console.error('정렬 상태 파싱 오류:', error);
                        currentSort = { column: null, direction: 'asc' };
                    }
                }
            }

            // 필터 상태 로드
            function loadFilterState() {
                const saved = localStorage.getItem('maplePartyFilterState');
                if (saved) {
                    try {
                        const filterState = JSON.parse(saved);
                        currentPlayer = filterState.currentPlayer || '';
                        currentBoss = filterState.currentBoss || '';
                        
                        const playerFilterInput = document.getElementById('playerFilterInput');
                        if (playerFilterInput) {
                            playerFilterInput.value = currentPlayer;
                        }
                        
                        const bossFilterInput = document.getElementById('bossFilterInput');
                        if (bossFilterInput) {
                            bossFilterInput.value = currentBoss;
                        }
                        
                        // 필터 상태 복원
                        if (filterState.hasFilter) {
                            applyFilters();
                        } else {
                            filteredParties = null;
                        }
                    } catch (error) {
                        console.error('필터 상태 파싱 오류:', error);
                        currentPlayer = '';
                        currentBoss = '';
                        filteredParties = null;
                    }
                }
            }

            // 파티 추가
            function addParty() {
                const party = {
                    id: partyCounter++,
                    characters: ['', '', '', '', '', ''],
                    boss: '',
                    day: '',
                    time: '',
                    cleared: false,
                    auctionPrice: 0
                };
                parties.push(party);
                saveData(); // 데이터 저장
                renderTable();
            }



            // 모든 파티 삭제
            function clearAllParties() {
                if (confirm('모든 파티를 삭제하시겠습니까?')) {
                    parties = [];
                    partyCounter = 1;
                    filteredParties = [];
                    currentPlayer = '';
                    currentSort = { column: null, direction: 'asc' };
                    
                    localStorage.removeItem('maplePartyBossData');
                    localStorage.removeItem('maplePartyHeaderData');
                    localStorage.removeItem('maplePartySortState');
                    localStorage.removeItem('maplePartyFilterState');
                    
                    const filterInput = document.getElementById('playerFilterInput');
                    if (filterInput) {
                        filterInput.value = '';
                    }
                    
                    renderTable();
                    alert('모든 데이터가 초기화되었습니다.');
                }
            }

            // 선택된 파티 삭제
            function deleteSelectedParties() {
                const selectedCheckboxes = document.querySelectorAll('.party-checkbox:checked');
                if (selectedCheckboxes.length === 0) {
                    alert('삭제할 파티를 선택해주세요.');
                    return;
                }
                
                if (confirm(`선택된 ${selectedCheckboxes.length}개의 파티를 삭제하시겠습니까?`)) {
                    const selectedIds = Array.from(selectedCheckboxes).map(cb => parseInt(cb.dataset.partyId));
                    parties = parties.filter(party => !selectedIds.includes(party.id));
                    saveData(); // 데이터 저장
                    renderTable();
                    alert(`${selectedIds.length}개의 파티가 삭제되었습니다.`);
                }
            }

            // 전체 선택/해제
            function toggleSelectAll() {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const partyCheckboxes = document.querySelectorAll('.party-checkbox');
                
                partyCheckboxes.forEach(checkbox => {
                    checkbox.checked = selectAllCheckbox.checked;
                });
            }

            // 파티 선택 상태 업데이트
            function updatePartySelection() {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const partyCheckboxes = document.querySelectorAll('.party-checkbox');
                const checkedCheckboxes = document.querySelectorAll('.party-checkbox:checked');
                
                if (checkedCheckboxes.length === 0) {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = false;
                } else if (checkedCheckboxes.length === partyCheckboxes.length) {
                    selectAllCheckbox.checked = true;
                    selectAllCheckbox.indeterminate = false;
                } else {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = true;
                }
            }



            // 파티 업데이트
            function updateParty(id, field, value) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    if (field === 'characters') {
                        const charIndex = parseInt(value.split('_')[1]);
                        party.characters[charIndex] = value.split('_')[2];
                        
                        // 캐릭터 입력 필드 스타일 업데이트
                        const row = document.querySelector(`div[data-party-id="${id}"]`);
                        if (row) {
                            const charInput = row.querySelector(`input[onchange*="char_${charIndex}_"]`);
                            if (charInput) {
                                if (party.characters[charIndex] && party.characters[charIndex].trim() !== '') {
                                    // 캐릭터가 있으면 일반 스타일
                                    charInput.style.backgroundColor = '';
                                    charInput.style.color = '';
                                    charInput.style.borderColor = '';
                                    charInput.placeholder = '';
                                } else {
                                    // 캐릭터가 없으면 은은한 스타일
                                    charInput.style.backgroundColor = '#f8f9fa';
                                    charInput.style.color = '#adb5bd';
                                    charInput.style.borderColor = '#e9ecef';
                                    charInput.placeholder = '빈 슬롯';
                                }
                            }
                        }
                    } else {
                        party[field] = value;
                    }
                    
                    if (field === 'boss') {
                        const row = document.querySelector(`div[data-party-id="${id}"]`);
                        if (row) {
                            const bossCell = row.querySelector('.boss-cell');
                            if (bossCell) {
                                bossCell.style.setProperty('--boss-color', getBossColor(value));
                            }
                        }
                    }
                    
                    saveData(); // 데이터 저장
                    renderTable();
                }
            }

            // 클리어 토글
            function toggleClear(id) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    party.cleared = !party.cleared;
                    
                    // 클리어 상태에 따라 CSS 클래스 추가/제거
                    const row = document.querySelector(`div[data-party-id="${id}"]`);
                    if (row) {
                        if (party.cleared) {
                            row.classList.add('cleared-party');
                        } else {
                            row.classList.remove('cleared-party');
                        }
                    }
                    
                    saveData(); // 데이터 저장
                    renderTable();
                }
            }

            // 테이블 정렬
            function sortTable(column) {
                if (currentSort.column === column) {
                    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.column = column;
                    currentSort.direction = 'asc';
                }

                const partiesToSort = filteredParties.length > 0 ? filteredParties : parties;
                partiesToSort.sort((a, b) => {
                    let aVal, bVal;
                    
                    switch(column) {
                        case 'boss':
                            aVal = a.boss || '';
                            bVal = b.boss || '';
                            break;
                        case 'day':
                            aVal = a.day || '';
                            bVal = b.day || '';
                            break;
                        case 'time':
                            aVal = a.time || '';
                            bVal = b.time || '';
                            break;
                        case 'cleared':
                            aVal = a.cleared ? 1 : 0;
                            bVal = b.cleared ? 1 : 0;
                            break;
                        case 'auctionPrice':
                            aVal = parseInt(a.auctionPrice) || 0;
                            bVal = parseInt(b.auctionPrice) || 0;
                            break;
                        case 'distribution':
                            aVal = calculateDistribution(a);
                            bVal = calculateDistribution(b);
                            break;
                        default:
                            return 0;
                    }

                    if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                    if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                    return 0;
                });

                updateSortHeaders();
                renderTable();
                saveSortState();
            }

            // 정렬 헤더 업데이트
            function updateSortHeaders() {
                const headers = document.querySelectorAll('.table-header div.sortable');
                headers.forEach(header => {
                    header.classList.remove('sorted-asc', 'sorted-desc');
                    if (header.onclick.toString().includes(currentSort.column)) {
                        header.classList.add(currentSort.direction === 'asc' ? 'sorted-asc' : 'sorted-desc');
                    }
                });
            }

            // 헤더 업데이트
            function updateHeader(index, value) {
                saveHeaderData();
            }

            // 보스 색상 가져오기
            function getBossColor(bossName) {
                return bossColors[bossName] || '#4CAF50';
            }

            // 참여자 수 계산
            function getParticipantCount(party) {
                return party.characters.filter(char => char && char.trim() !== '').length;
            }

            // 분배금 계산
            function calculateDistribution(party) {
                const participantCount = getParticipantCount(party);
                const auctionPrice = parseInt(party.auctionPrice) || 0;
                
                if (participantCount === 0 || auctionPrice === 0) {
                    return 0;
                }
                
                const feeRate = 0.03;
                const totalMembers = participantCount;
                
                const receivedAmount = Math.round(auctionPrice * (1 - feeRate));
                const actualReceivedAmount = Math.round(receivedAmount / (1 + (totalMembers - 1) / (1 - feeRate)));
                const distributionAmount = Math.round(actualReceivedAmount / (1 - feeRate));
                
                return distributionAmount;
            }

            // 숫자에 콤마 추가
            function addCommas(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }

            // 억/만 단위로 변환
            function formatToKoreanCurrency(num) {
                if (num === 0) return '0메소';
                
                const eok = Math.floor(num / 100000000);
                const man = Math.floor((num % 100000000) / 10000);
                const remainder = num % 10000;
                
                let result = '';
                if (eok > 0) result += `${eok}억`;
                if (man > 0) result += `${man}만`;
                if (remainder > 0) result += `${remainder}`;
                
                return result + '메소';
            }

            // 경매장 가격 업데이트
            function updateAuctionPrice(id, value) {
                const party = parties.find(p => p.id === id);
                if (party) {
                    // 콤마 제거 후 숫자만 추출
                    const cleanValue = value.replace(/,/g, '');
                    party.auctionPrice = parseInt(cleanValue) || 0;
                    saveData(); // 데이터 저장
                    renderTable();
                }
            }

            // 경매장 가격 입력 시 실시간 포맷팅
            function formatAuctionPriceInput(input) {
                const value = input.value.replace(/,/g, '');
                const numValue = parseInt(value) || 0;
                input.value = addCommas(numValue);
                
                // 옆에 있는 단위 표시 업데이트
                const unitDisplay = input.parentNode.querySelector('.auction-unit-display');
                if (unitDisplay) {
                    unitDisplay.textContent = formatToKoreanCurrency(numValue);
                }
            }

            // 헤더 플레이어명 가져오기
            function getHeaderPlayerNames() {
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                const playerNames = [];
                headerCells.forEach(cell => {
                    playerNames.push(cell.textContent.trim());
                });
                return playerNames;
            }

            // 플레이어가 파티에 참여하는지 확인
            function isPlayerInParty(party, playerName) {
                if (!playerName) return false;
                
                const headerPlayers = getHeaderPlayerNames();
                const playerIndex = headerPlayers.indexOf(playerName);
                
                if (playerIndex === -1) return false;
                
                const characterSlot = party.characters[playerIndex];
                return characterSlot && characterSlot.trim() !== '';
            }

            // 플레이어 필터링
            function filterByPlayer(playerName) {
                currentPlayer = playerName.trim();
                applyFilters();
            }

            // 보스 필터링
            function filterByBoss(bossName) {
                currentBoss = bossName.trim();
                applyFilters();
            }

            // 필터 적용
            function applyFilters() {
                // 두 필터가 모두 비어있으면 필터 해제
                if (currentPlayer === '' && currentBoss === '') {
                    filteredParties = null; // null로 설정하여 필터가 없음을 표시
                } else {
                    let tempFiltered = parties;
                    
                    // 보스 필터 적용
                    if (currentBoss !== '') {
                        tempFiltered = tempFiltered.filter(party => 
                            party.boss.toLowerCase().includes(currentBoss.toLowerCase())
                        );
                    }
                    
                    // 플레이어 필터 적용
                    if (currentPlayer !== '') {
                        const playerParties = tempFiltered.filter(party => isPlayerInParty(party, currentPlayer));
                        const otherParties = tempFiltered.filter(party => !isPlayerInParty(party, currentPlayer));
                        tempFiltered = [...playerParties, ...otherParties];
                    }
                    
                    filteredParties = tempFiltered;
                }
                
                renderTable();
                saveFilterState();
            }

            // 전체 파티 보기
            function showAllParties() {
                filteredParties = null; // null로 설정하여 필터 해제
                currentPlayer = '';
                currentBoss = '';
                
                const playerFilterInput = document.getElementById('playerFilterInput');
                const bossFilterInput = document.getElementById('bossFilterInput');
                
                if (playerFilterInput) playerFilterInput.value = '';
                if (bossFilterInput) bossFilterInput.value = '';
                
                renderTable();
                saveFilterState();
            }

            // 플레이어 파티만 보기
            function showPlayerParties() {
                const inputValue = document.getElementById('playerFilterInput').value.trim();
                if (inputValue === '') {
                    alert('먼저 플레이어명을 입력해주세요.');
                    return;
                }
                
                currentPlayer = inputValue;
                const headerPlayers = getHeaderPlayerNames();
                
                if (headerPlayers.includes(currentPlayer)) {
                    filteredParties = parties.filter(party => isPlayerInParty(party, currentPlayer));
                } else {
                    alert('헤더에 등록되지 않은 플레이어입니다.');
                    filteredParties = [];
                }
                
                renderTable();
                saveFilterState();
            }

            // 테이블 렌더링
            function renderTable() {
                const tbody = document.getElementById('partyTableBody');
                tbody.innerHTML = '';

                // 디버깅: parties 배열 상태 확인
                console.log('renderTable - parties length:', parties.length);
                console.log('renderTable - parties:', parties);

                let partiesToShow = filteredParties !== null ? filteredParties : parties;
                
                if (currentSort.column) {
                    partiesToShow = [...partiesToShow];
                    partiesToShow.sort((a, b) => {
                        let aVal, bVal;
                        
                        switch(currentSort.column) {
                            case 'boss':
                                aVal = a.boss || '';
                                bVal = b.boss || '';
                                break;
                            case 'day':
                                aVal = a.day || '';
                                bVal = b.day || '';
                                break;
                            case 'time':
                                aVal = a.time || '';
                                bVal = b.time || '';
                                break;
                            case 'cleared':
                                aVal = a.cleared ? 1 : 0;
                                bVal = b.cleared ? 1 : 0;
                                break;
                            case 'auctionPrice':
                                aVal = parseInt(a.auctionPrice) || 0;
                                bVal = parseInt(b.auctionPrice) || 0;
                                break;
                            case 'distribution':
                                aVal = calculateDistribution(a);
                                bVal = calculateDistribution(b);
                                break;
                            default:
                                return 0;
                        }

                        if (aVal < bVal) return currentSort.direction === 'asc' ? -1 : 1;
                        if (aVal > bVal) return currentSort.direction === 'asc' ? 1 : -1;
                        return 0;
                    });
                }

                partiesToShow.forEach(party => {
                    const row = document.createElement('div');
                    row.className = 'party-row';
                    row.setAttribute('data-party-id', party.id);
                    
                    const distributionAmount = calculateDistribution(party);
                    const participantCount = getParticipantCount(party);
                    
                    if (currentPlayer && isPlayerInParty(party, currentPlayer)) {
                        row.classList.add('player-party');
                    }
                    
                    if (party.cleared) {
                        row.classList.add('cleared-party');
                    }
                    
                    row.innerHTML = `
                        <div>
                            <input type="checkbox" class="party-checkbox" data-party-id="${party.id}" onchange="updatePartySelection()" style="width: 16px; height: 16px; cursor: pointer; margin: 0;">
                        </div>
                        <div class="boss-cell" style="--boss-color: ${getBossColor(party.boss)}">
                            <input type="text" class="boss-input" value="${party.boss}" 
                                onchange="updateParty(${party.id}, 'boss', this.value)" 
                                placeholder="보스명">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[0] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_0_' + this.value)"
                                placeholder="${party.characters[0] ? '' : '빈 슬롯'}"
                                style="${party.characters[0] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[1] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_1_' + this.value)"
                                placeholder="${party.characters[1] ? '' : '빈 슬롯'}"
                                style="${party.characters[1] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[2] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_2_' + this.value)"
                                placeholder="${party.characters[2] ? '' : '빈 슬롯'}"
                                style="${party.characters[2] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[3] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_3_' + this.value)"
                                placeholder="${party.characters[3] ? '' : '빈 슬롯'}"
                                style="${party.characters[3] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[4] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_4_' + this.value)"
                                placeholder="${party.characters[4] ? '' : '빈 슬롯'}"
                                style="${party.characters[4] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <input type="text" class="character-input" value="${party.characters[5] || ''}" 
                                onchange="updateParty(${party.id}, 'characters', 'char_5_' + this.value)"
                                placeholder="${party.characters[5] ? '' : '빈 슬롯'}"
                                style="${party.characters[5] ? '' : 'background-color: #f8f9fa; color: #adb5bd; border-color: #e9ecef;'}">
                        </div>
                        <div>
                            <select class="time-input" onchange="updateParty(${party.id}, 'day', this.value)" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                                <option value="">요일</option>
                                <option value="월" ${party.day === '월' ? 'selected' : ''}>월</option>
                                <option value="화" ${party.day === '화' ? 'selected' : ''}>화</option>
                                <option value="수" ${party.day === '수' ? 'selected' : ''}>수</option>
                                <option value="목" ${party.day === '목' ? 'selected' : ''}>목</option>
                                <option value="금" ${party.day === '금' ? 'selected' : ''}>금</option>
                                <option value="토" ${party.day === '토' ? 'selected' : ''}>토</option>
                                <option value="일" ${party.day === '일' ? 'selected' : ''}>일</option>
                            </select>
                        </div>
                        <div>
                            <input type="text" class="time-input" value="${party.time || ''}" 
                                onchange="updateParty(${party.id}, 'time', this.value)"
                                placeholder="시간" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 14px;">
                        </div>
                        <div>
                            <input type="checkbox" class="clear-checkbox" ${party.cleared ? 'checked' : ''} 
                                onchange="toggleClear(${party.id})">
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 2px;">
                            <input type="text" class="auction-input" value="${party.auctionPrice ? addCommas(party.auctionPrice) : ''}" 
                                onchange="updateAuctionPrice(${party.id}, this.value)"
                                oninput="formatAuctionPriceInput(this)"
                                placeholder="0" style="text-align: center; width: 100%;">
                            <div class="auction-unit-display" style="font-size: 10px; color: #666; font-weight: bold;">
                                ${party.auctionPrice ? formatToKoreanCurrency(party.auctionPrice) : '0메소'}
                            </div>
                        </div>
                        <div>
                            <div class="distribution-amount" title="엑셀 공식: 경매장판매가 ${party.auctionPrice ? party.auctionPrice.toLocaleString() : 0}메소 → 경매장수령가 ${party.auctionPrice ? Math.round(party.auctionPrice * 0.97).toLocaleString() : 0}메소 → N명실수령액 ${party.auctionPrice && participantCount > 0 ? Math.round(Math.round(party.auctionPrice * 0.97) / (1 + (participantCount - 1) / 0.97)).toLocaleString() : 0}메소 → 분배자1인당지급금액 ${distributionAmount.toLocaleString()}메소">
                                ${distributionAmount.toLocaleString()}메소
                            </div>
                        </div>
                    `;

                    tbody.appendChild(row);
                });

                updateSortHeaders();
                updateStats();
            }

            // 통계 업데이트
            function updateStats() {
                const partiesToShow = filteredParties !== null ? filteredParties : parties;
                const totalParties = partiesToShow.length;
                const clearedParties = partiesToShow.filter(p => p.cleared).length;
                
                const totalAuctionPrice = partiesToShow.reduce((sum, party) => sum + (party.auctionPrice || 0), 0);
                const totalDistribution = partiesToShow.reduce((sum, party) => {
                    const participantCount = getParticipantCount(party);
                    if (participantCount > 0) {
                        const distributionPerPerson = calculateDistribution(party);
                        return sum + (distributionPerPerson * participantCount);
                    }
                    return sum;
                }, 0);

                document.getElementById('totalParties').textContent = totalParties;
                document.getElementById('clearedParties').textContent = clearedParties;
                document.getElementById('totalAuctionPrice').textContent = totalAuctionPrice.toLocaleString() + '메소';
                document.getElementById('totalDistribution').textContent = totalDistribution.toLocaleString() + '메소';
            }

            // 데이터 저장
            function saveData() {
                // 클리어된 파티들을 맨 아래로 정렬
                const sortedParties = [...parties].sort((a, b) => {
                    if (a.cleared && !b.cleared) return 1;
                    if (!a.cleared && b.cleared) return -1;
                    return 0;
                });
                
                const dataToSave = {
                    parties: sortedParties,
                    partyCounter: partyCounter,
                    headerData: (() => {
                        try {
                            const headerValues = [];
                            const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                            headerCells.forEach(cell => {
                                headerValues.push(cell.textContent.trim());
                            });
                            return headerValues;
                        } catch (error) {
                            console.error('헤더 데이터 가져오기 오류:', error);
                            return [];
                        }
                    })(),
                    sortState: currentSort,
                    filterState: {
                        currentPlayer: currentPlayer,
                        currentBoss: currentBoss,
                        filteredParties: filteredParties
                    }
                };
                
                // 로컬 스토리지에 저장
                localStorage.setItem('maplePartyBossData', JSON.stringify(dataToSave));
                
                // 정렬된 파티로 업데이트
                parties = sortedParties;
                
                            // GitHub API가 활성화되어 있으면 GitHub에도 저장
            if (githubConfig.enabled && githubConfig.token) {
                console.log('GitHub에 데이터 저장 중...');
                // GitHub 저장을 비동기로 처리하되 오류가 발생해도 로컬 저장은 유지
                saveDataToGitHub(dataToSave).catch(error => {
                    console.error('GitHub 저장 실패 (로컬 저장은 완료됨):', error);
                });
            }
        }

            // 헤더 데이터 가져오기
            function getHeaderData() {
                const headerValues = [];
                const headerCells = document.querySelectorAll('#tableHeader div.header-input');
                headerCells.forEach(cell => {
                    headerValues.push(cell.textContent.trim());
                });
                return headerValues;
            }

            // 헤더 데이터 저장
            function saveHeaderData() {
                const headerValues = getHeaderData();
                localStorage.setItem('maplePartyHeaderData', JSON.stringify(headerValues));
            }

            // 정렬 상태 저장
            function saveSortState() {
                localStorage.setItem('maplePartySortState', JSON.stringify(currentSort));
            }

            // 필터 상태 저장
            function saveFilterState() {
                const filterState = {
                    currentPlayer: currentPlayer,
                    currentBoss: currentBoss,
                    hasFilter: filteredParties !== null
                };
                localStorage.setItem('maplePartyFilterState', JSON.stringify(filterState));
            }

            // 모든 데이터 저장
            async function saveAllData() {
                saveData();
                saveHeaderData();
                saveSortState();
                saveFilterState();
                renderTable(); // 저장 후 테이블 다시 렌더링
                
                // GitHub API를 통한 저장 시도
                if (githubConfig.enabled && githubConfig.token) {
                    try {
                        const success = await saveDataToGitHub();
                        if (success) {
                            alert('✅ 모든 데이터가 저장되었습니다!\n\n🔗 GitHub와 동기화되었습니다.\n\n다른 사용자들이 새로고침하면 최신 데이터를 볼 수 있습니다.');
                            return;
                        }
                    } catch (error) {
                        console.error('GitHub 저장 실패:', error);
                        alert('⚠️ GitHub 저장에 실패했습니다.\n\n로컬에만 저장되었습니다.');
                    }
                }
                
                // GitHub API가 비활성화된 경우
                alert('✅ 모든 데이터가 로컬에 저장되었습니다!');
            }
            
            
            
            
            
            
            
            
            
            
            // GitHub API 설정
            function setupGitHubAPI() {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: white;
                        padding: 30px;
                        border-radius: 15px;
                        max-width: 600px;
                        width: 90%;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                    ">
                        <h3 style="margin-bottom: 20px; color: #4CAF50;">⚙️ GitHub API 설정</h3>
                        <div style="margin-bottom: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border-left: 4px solid #4CAF50;">
                            <p style="margin: 0; font-weight: bold; color: #2e7d32;">📋 설정 방법:</p>
                            <ol style="margin: 10px 0 0 20px; color: #2e7d32; font-size: 14px;">
                                <li>GitHub → Settings → Developer settings → Personal access tokens</li>
                                <li>Generate new token (classic) 클릭</li>
                                <li>repo 권한 체크 후 토큰 생성</li>
                                <li>생성된 토큰을 아래에 입력</li>
                            </ol>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">GitHub Personal Access Token:</label>
                            <input type="password" id="githubTokenInput" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #4CAF50;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                            ">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">저장소 소유자:</label>
                            <input type="text" id="githubOwnerInput" value="rlarhkd99-beep" readonly style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #ddd;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                                background-color: #f5f5f5;
                            ">
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">저장소 이름:</label>
                            <input type="text" id="githubRepoInput" value="Maple" readonly style="
                                width: 100%;
                                padding: 10px;
                                border: 2px solid #ddd;
                                border-radius: 8px;
                                font-family: monospace;
                                font-size: 12px;
                                background-color: #f5f5f5;
                            ">
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="testGitHubConnection()" style="
                                padding: 10px 20px;
                                background: #2196F3;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">🔗 연결 테스트</button>
                            <button onclick="saveGitHubConfig()" style="
                                padding: 10px 20px;
                                background: #4CAF50;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">💾 설정 저장</button>
                            <button onclick="this.closest('.modal').remove()" style="
                                padding: 10px 20px;
                                background: #f44336;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                cursor: pointer;
                            ">닫기</button>
                        </div>
                    </div>
                `;
                
                modal.className = 'modal';
                document.body.appendChild(modal);
                
                // 기존 설정 로드
                loadGitHubConfig();
                
                // 모달 외부 클릭 시 닫기
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
            }
            
            // GitHub 설정 로드
            function loadGitHubConfig() {
                const saved = localStorage.getItem('githubConfig');
                if (saved) {
                    try {
                        githubConfig = JSON.parse(saved);
                        const tokenInput = document.getElementById('githubTokenInput');
                        if (tokenInput) {
                            tokenInput.value = githubConfig.token;
                        }
                    } catch (error) {
                        console.error('GitHub 설정 로드 오류:', error);
                    }
                }
            }
            
            // GitHub 설정 저장
            function saveGitHubConfig() {
                const tokenInput = document.getElementById('githubTokenInput');
                const ownerInput = document.getElementById('githubOwnerInput');
                const repoInput = document.getElementById('githubRepoInput');
                
                if (!tokenInput.value.trim()) {
                    alert('GitHub 토큰을 입력해주세요.');
                    return;
                }
                
                githubConfig.token = tokenInput.value.trim();
                githubConfig.owner = ownerInput.value.trim();
                githubConfig.repo = repoInput.value.trim();
                githubConfig.enabled = true;
                
                localStorage.setItem('githubConfig', JSON.stringify(githubConfig));
                
                document.querySelector('.modal').remove();
                updateGitHubStatus();
                
                alert('✅ GitHub API 설정이 저장되었습니다!\n\n이제 데이터를 GitHub와 동기화할 수 있습니다.');
            }
            
            // GitHub 연결 테스트
            async function testGitHubConnection() {
                const tokenInput = document.getElementById('githubTokenInput');
                const ownerInput = document.getElementById('githubOwnerInput');
                const repoInput = document.getElementById('githubRepoInput');
                
                if (!tokenInput.value.trim()) {
                    alert('GitHub 토큰을 입력해주세요.');
                    return;
                }
                
                const testConfig = {
                    token: tokenInput.value.trim(),
                    owner: ownerInput.value.trim(),
                    repo: repoInput.value.trim()
                };
                
                try {
                    const response = await fetch(`https://api.github.com/repos/${testConfig.owner}/${testConfig.repo}`, {
                        headers: {
                            'Authorization': `token ${testConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        alert('✅ GitHub 연결 성공!\n\n저장소에 접근할 수 있습니다.');
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    alert(`❌ GitHub 연결 실패!\n\n오류: ${error.message}\n\n토큰과 저장소 정보를 확인해주세요.`);
                    console.error('GitHub 연결 오류:', error);
                }
            }
            
            // GitHub 상태 업데이트
            function updateGitHubStatus() {
                const githubStatus = document.getElementById('githubStatus');
                if (githubStatus) {
                    if (githubConfig.enabled && githubConfig.token) {
                        githubStatus.innerHTML = '🔗 <strong>GitHub 동기화 활성화</strong> - 데이터가 GitHub와 동기화됩니다.';
                        githubStatus.style.color = '#4CAF50';
                    } else {
                        githubStatus.innerHTML = '💾 <strong>로컬 모드</strong> - GitHub API를 설정하면 데이터를 공유할 수 있습니다.';
                        githubStatus.style.color = '#FF9800';
                    }
                }
            }
            
            // GitHub에서 데이터 로드
            async function loadDataFromGitHub() {
                if (!githubConfig.enabled || !githubConfig.token) {
                    return false;
                }
                
                try {
                    const response = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                        headers: {
                            'Authorization': `token ${githubConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        const fileData = await response.json();
                        
                        // Base64 디코딩 시 인코딩 문제 해결
                        const decodedContent = atob(fileData.content);
                        const jsonData = JSON.parse(decodedContent);
                        
                        console.log('GitHub에서 로드된 데이터:', jsonData);
                        console.log('GitHub 데이터의 parties:', jsonData.parties);
                        console.log('GitHub 데이터의 parties 길이:', jsonData.parties ? jsonData.parties.length : 'undefined');
                        
                        // 첫 번째 파티의 상세 내용 확인
                        if (jsonData.parties && jsonData.parties.length > 0) {
                            console.log('첫 번째 파티 상세 내용:', jsonData.parties[0]);
                            console.log('첫 번째 파티의 보스:', jsonData.parties[0].boss);
                            console.log('첫 번째 파티의 캐릭터들:', jsonData.parties[0].characters);
                        }
                        
                        // 인코딩 문제가 있는 경우 기본 데이터 사용
                        if (!jsonData.parties || jsonData.parties.length === 0) {
                            console.log('GitHub 데이터에 문제가 있어 기본 데이터를 사용합니다.');
                            return false;
                        }
                        
                        loadSharedData(jsonData);
                        return true;
                    } else if (response.status === 404) {
                        console.log('GitHub에 데이터 파일이 없습니다. 로컬 데이터를 사용합니다.');
                        return false;
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub 데이터 로드 오류:', error);
                    return false;
                }
            }
            
            // GitHub에 데이터 저장
            async function saveDataToGitHub() {
                if (!githubConfig.enabled || !githubConfig.token) {
                    return false;
                }
                
                try {
                    const currentHeaderData = getHeaderPlayerNames();
                    
                    const shareData = {
                        parties: parties,
                        partyCounter: partyCounter,
                        headerData: currentHeaderData,
                        sortState: currentSort,
                        filterState: {
                            currentPlayer: currentPlayer,
                            currentBoss: currentBoss,
                            filteredParties: filteredParties ? filteredParties.map(p => p.id) : null
                        },
                        lastUpdated: new Date().toISOString()
                    };
                    
                    const jsonString = JSON.stringify(shareData, null, 2);
                    const encodedContent = btoa(unescape(encodeURIComponent(jsonString)));
                    
                    // 기존 파일 정보 가져오기
                    let sha = null;
                    try {
                        const getResponse = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                            headers: {
                                'Authorization': `token ${githubConfig.token}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        });
                        
                        if (getResponse.ok) {
                            const fileData = await getResponse.json();
                            sha = fileData.sha;
                        }
                    } catch (error) {
                        console.log('기존 파일이 없습니다. 새로 생성합니다.');
                    }
                    
                    // 파일 업데이트/생성
                    const updateResponse = await fetch(`https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.filePath}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `token ${githubConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `메이플 파티보스 데이터 업데이트 - ${new Date().toLocaleString()}`,
                            content: encodedContent,
                            sha: sha
                        })
                    });
                    
                    if (updateResponse.ok) {
                        console.log('GitHub에 데이터가 성공적으로 저장되었습니다.');
                        return true;
                    } else {
                        throw new Error(`HTTP ${updateResponse.status}: ${updateResponse.statusText}`);
                    }
                } catch (error) {
                    console.error('GitHub 데이터 저장 오류:', error);
                    return false;
                }
            }

            // 요일 일괄 삭제
            function clearAllDays() {
                if (confirm('모든 파티의 요일을 삭제하시겠습니까?')) {
                    parties.forEach(party => {
                        party.day = '';
                    });
                    saveData(); // 데이터 저장
                    renderTable();
                    alert('모든 파티의 요일이 삭제되었습니다.');
                }
            }

            // 시간 일괄 삭제
            function clearAllTimes() {
                if (confirm('모든 파티의 시간을 삭제하시겠습니까?')) {
                    parties.forEach(party => {
                        party.time = '';
                    });
                    saveData(); // 데이터 저장
                    renderTable();
                    alert('모든 파티의 시간이 삭제되었습니다.');
                }
            }

            // 클리어 일괄 해제
            function clearAllCleared() {
                if (confirm('모든 파티의 클리어 상태를 해제하시겠습니까?')) {
                    parties.forEach(party => {
                        party.cleared = false;
                    });
                    saveData(); // 데이터 저장
                    renderTable();
                    alert('모든 파티의 클리어 상태가 해제되었습니다.');
                }
            }

            // 경매장 판매가 일괄 삭제
            function clearAllAuctionPrices() {
                if (confirm('모든 파티의 경매장 판매가를 삭제하시겠습니까?')) {
                    parties.forEach(party => {
                        party.auctionPrice = 0;
                    });
                    saveData(); // 데이터 저장
                    renderTable();
                    alert('모든 파티의 경매장 판매가가 삭제되었습니다.');
                }
            }

            // 파일로 저장
            function saveAsFile() {
                const currentHeaderData = getHeaderPlayerNames();
                
                const currentData = {
                    parties: parties,
                    partyCounter: partyCounter,
                    headerData: currentHeaderData,
                    sortState: currentSort,
                    filterState: {
                        currentPlayer: currentPlayer,
                        currentBoss: currentBoss,
                        filteredParties: filteredParties ? filteredParties.map(p => p.id) : null
                    }
                };
                
                const htmlContent = generateHTMLWithData(currentData);
                
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `메이플_파티보스_관리_${new Date().toISOString().split('T')[0]}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                const shareUrl = generateShareUrl();
                alert(`현재 데이터가 포함된 HTML 파일이 저장되었습니다!\n\n공유 URL: ${shareUrl}\n\n이 URL을 다른 사람들과 공유하면 같은 데이터를 볼 수 있습니다.`);
            }

            // HTML 생성
            function generateHTMLWithData(data) {
                const currentHTML = document.documentElement.outerHTML;
                
                const startMarker = 'const EMBEDDED_DATA = {';
                const endMarker = '};';
                
                const startIndex = currentHTML.indexOf(startMarker);
                const endIndex = currentHTML.indexOf(endMarker, startIndex) + endMarker.length;
                
                if (startIndex === -1 || endIndex === -1) {
                    return currentHTML;
                }
                
                const newEmbeddedData = `const EMBEDDED_DATA = ${JSON.stringify(data, null, 4)};`;
                const newHTML = currentHTML.substring(0, startIndex) + newEmbeddedData + currentHTML.substring(endIndex);
                
                return newHTML;
            }




        </script>


    </body></html>
